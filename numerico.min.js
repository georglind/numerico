"use strict";var numeric="undefined"==typeof exports?function(){}:exports;"undefined"!=typeof global&&(global.numeric=numeric),function(numeric){numeric.version="1.2.6",numeric.bench=function(r,n){var e,i,t,u;for("undefined"==typeof n&&(n=15),t=.5,e=new Date;;){for(t*=2,u=t;u>3;u-=4)r(),r(),r(),r();for(;u>0;)r(),u--;if(i=new Date,i-e>n)break}for(u=t;u>3;u-=4)r(),r(),r(),r();for(;u>0;)r(),u--;return i=new Date,1e3*(3*t-1)/(i-e)},numeric._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(r){function n(r){if(0===r)return"0";if(isNaN(r))return"NaN";if(r<0)return"-"+n(-r);if(isFinite(r)){var e=Math.floor(Math.log(r)/Math.log(10)),i=r/Math.pow(10,e),t=i.toPrecision(numeric.precision);return 10===parseFloat(t)&&(e++,i=1,t=i.toPrecision(numeric.precision)),parseFloat(t).toString()+"e"+e.toString()}return"Infinity"}function e(r){var t;if("undefined"==typeof r)return i.push(Array(numeric.precision+8).join(" ")),!1;if("string"==typeof r)return i.push('"'+r+'"'),!1;if("boolean"==typeof r)return i.push(r.toString()),!1;if("number"==typeof r){var u=n(r),o=r.toPrecision(numeric.precision),c=parseFloat(r.toString()).toString(),m=[u,o,c,parseFloat(o).toString(),parseFloat(c).toString()];for(t=1;t<m.length;t++)m[t].length<u.length&&(u=m[t]);return i.push(Array(numeric.precision+8-u.length).join(" ")+u),!1}if(null===r)return i.push("null"),!1;if("function"==typeof r){i.push(r.toString());var a=!1;for(t in r)r.hasOwnProperty(t)&&(a?i.push(",\n"):i.push("\n{"),a=!0,i.push(t),i.push(": \n"),e(r[t]));return a&&i.push("}\n"),!0}if(r instanceof Array){if(r.length>numeric.largeArray)return i.push("...Large Array..."),!0;var a=!1;for(i.push("["),t=0;t<r.length;t++)t>0&&(i.push(","),a&&i.push("\n ")),a=e(r[t]);return i.push("]"),!0}i.push("{");var a=!1;for(t in r)r.hasOwnProperty(t)&&(a&&i.push(",\n"),a=!0,i.push(t),i.push(": \n"),e(r[t]));return i.push("}"),!0}var i=[];return e(r),i.join("")},numeric.parseDate=function(r){function n(r){if("string"==typeof r)return Date.parse(r.replace(/-/g,"/"));if(!(r instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var e,i=[];for(e=0;e<r.length;e++)i[e]=n(r[e]);return i}return n(r)},numeric.parseFloat=function(r){function n(r){if("string"==typeof r)return parseFloat(r);if(!(r instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var e,i=[];for(e=0;e<r.length;e++)i[e]=n(r[e]);return i}return n(r)},numeric.parseCSV=function(r){var n,e,i=r.split("\n"),t=[],u=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,c=function(r){return r.substr(0,r.length-1)},m=0;for(e=0;e<i.length;e++)if(""!==i[e]){var a,f=(i[e]+",").match(u);if(f.length>0){for(t[m]=[],n=0;n<f.length;n++)a=c(f[n]),o.test(a)?t[m][n]=parseFloat(a):t[m][n]=a;m++}}return t},numeric.toCSV=function(r){var n,e,i=numeric.dim(r),t=i[0],u=i[1],o=[],c=[];for(n=0;n<t;n++){for(o=[],e=0;e<u;e++)o[e]=r[n][e].toString();c[n]=o.join(", ")}return c.join("\n")+"\n"},numeric.getURL=function(r){var n=new XMLHttpRequest;return n.open("GET",r,!1),n.send(),n},numeric.imageURL=function(r){function n(r){var n,e,i,t,u,o,c,m,a=r.length,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="";for(n=0;n<a;n+=3)e=r[n],i=r[n+1],t=r[n+2],u=e>>2,o=((3&e)<<4)+(i>>4),c=((15&i)<<2)+(t>>6),m=63&t,n+1>=a?c=m=64:n+2>=a&&(m=64),s+=f.charAt(u)+f.charAt(o)+f.charAt(c)+f.charAt(m);return s}function e(r,n,e){"undefined"==typeof n&&(n=0),"undefined"==typeof e&&(e=r.length);var i,t=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],u=-1,o=0;r.length;for(i=n;i<e;i++)o=255&(u^r[i]),u=u>>>8^t[o];return u^-1}var i,t,u,o,c,m,a,f,s,h,p=r[0].length,l=r[0][0].length,y=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,l>>24&255,l>>16&255,l>>8&255,255&l,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=e(y,12,29),y[29]=h>>24&255,y[30]=h>>16&255,y[31]=h>>8&255,y[32]=255&h,i=1,t=0,a=0;a<p;a++){for(a<p-1?y.push(0):y.push(1),c=3*l+1+(0===a)&255,m=3*l+1+(0===a)>>8&255,y.push(c),y.push(m),y.push(255&~c),y.push(255&~m),0===a&&y.push(0),f=0;f<l;f++)for(u=0;u<3;u++)c=r[u][a][f],c=c>255?255:c<0?0:Math.round(c),i=(i+c)%65521,t=(t+i)%65521,y.push(c);y.push(0)}return s=(t<<16)+i,y.push(s>>24&255),y.push(s>>16&255),y.push(s>>8&255),y.push(255&s),o=y.length-41,y[33]=o>>24&255,y[34]=o>>16&255,y[35]=o>>8&255,y[36]=255&o,h=e(y,37),y.push(h>>24&255),y.push(h>>16&255),y.push(h>>8&255),y.push(255&h),y.push(0),y.push(0),y.push(0),y.push(0),y.push(73),y.push(69),y.push(78),y.push(68),y.push(174),y.push(66),y.push(96),y.push(130),"data:image/png;base64,"+n(y)},numeric._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},numeric.dim=function(r){var n,e;return"object"==typeof r?(n=r[0],"object"==typeof n?(e=n[0],"object"==typeof e?numeric._dim(r):[r.length,n.length]):[r.length]):[]},numeric.flatten=function(r,n,e){if("object"!=typeof r)return r;if("undefined"==typeof e&&(e=0),"undefined"==typeof n&&(n=numeric.dim(r)),e===n.length-1)return r;var i,t=r.length,u=[];for(i=0;i<t;++i)u=u.concat(numeric.flatten(r[i],n,e+1));return u},numeric._reshape=function(r,n,e){if(e===n.length-1)return r.splice(0,n[e]);var i,t=n[e],u=Array(t);for(i=0;i<t;++i)u[i]=numeric._reshape(r,n,e+1);return u},numeric.reshape=function(r,n,e){return numeric._reshape(numeric.flatten(r),n,0)},numeric.concat=function(r,n,e,i,t){if("undefined"==typeof t&&(t=0),"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=numeric.dim(r)),e<0&&(e=i.length+e),e===t)return r.concat(n);var u,o=i[t],c=Array(o);for(u=o-1;u>=0;--u)c[u]=numeric.concat(r[u],n[u],e,i,t+1);return c},numeric.stack=function(r,n){var e,i=r[0],t=r.length;for(e=1;e<t;e++)i=numeric.concat(i,r[e],n);return i},numeric.hstack=function(r){return numeric.stack(r,-1)},numeric.vstack=function(r){return numeric.stack(r,-2)},numeric.dstack=function(r){return numeric.stack(r,-3)},numeric.same=function r(n,e){var i,t;if(!(n instanceof Array&&e instanceof Array))return!1;if(t=n.length,t!==e.length)return!1;for(i=0;i<t;i++)if(n[i]!==e[i]){if("object"!=typeof n[i])return!1;if(!r(n[i],e[i]))return!1}return!0},numeric.empty=function(r,n){"undefined"==typeof n&&(n=0);var e,i=r[n],t=Array(i);if(0!==r.length){if(r.length-1===n)return t;for(e=i-1;e>=0;e--)t[e]=numeric.empty(r,n+1);return t}},numeric.rep=function(r,n,e){"undefined"==typeof e&&(e=0);var i,t=r[e],u=Array(t);if(0===r.length)return n;if(r.length-1===e){for(i=t-2;i>=0;i-=2)u[i+1]=n,u[i]=n;return i===-1&&(u[0]=n),u}for(i=t-1;i>=0;i--)u[i]=numeric.rep(r,n,e+1);return u},numeric.zeros=function(r){return numeric.rep(r,0)},numeric.ones=function(r){return numeric.rep(r,1)},numeric.dotMMsmall=function(r,n){var e,i,t,u,o,c,m,a,f,s,h;for(u=r.length,o=n.length,c=n[0].length,m=Array(u),e=u-1;e>=0;e--){for(a=Array(c),f=r[e],t=c-1;t>=0;t--){for(s=f[o-1]*n[o-1][t],i=o-2;i>=1;i-=2)h=i-1,s+=f[i]*n[i][t]+f[h]*n[h][t];0===i&&(s+=f[0]*n[0][t]),a[t]=s}m[e]=a}return m},numeric._getCol=function(r,n,e){var i,t=r.length;for(i=t-1;i>0;--i)e[i]=r[i][n],--i,e[i]=r[i][n];0===i&&(e[0]=r[0][n])},numeric.dotMMbig=function(r,n){var e,i,t,u,o=numeric._getCol,c=n.length,m=Array(c),a=r.length,f=n[0].length,s=new Array(a),h=numeric.dotVV;for(--c,--a,i=a;i!==-1;--i)s[i]=Array(f);for(--f,i=f;i!==-1;--i)for(o(n,i,m),t=a;t!==-1;--t)u=0,e=r[t],s[t][i]=h(e,m);return s},numeric.dotMV=function(r,n){var e,i=r.length,t=(n.length,Array(i)),u=numeric.dotVV;for(e=i-1;e>=0;e--)t[e]=u(r[e],n);return t},numeric.dotVM=function(r,n){var e,i,t,u,o,c,m;for(t=r.length,u=n[0].length,o=Array(u),i=u-1;i>=0;i--){for(c=r[t-1]*n[t-1][i],e=t-2;e>=1;e-=2)m=e-1,c+=r[e]*n[e][i]+r[m]*n[m][i];0===e&&(c+=r[0]*n[0][i]),o[i]=c}return o},numeric.dotVV=function(r,n){var e,i,t=r.length,u=r[t-1]*n[t-1];for(e=t-2;e>=1;e-=2)i=e-1,u+=r[e]*n[e]+r[i]*n[i];return 0===e&&(u+=r[0]*n[0]),u},numeric.dot=function(r,n){var e=numeric.dim;switch(1e3*e(r).length+e(n).length){case 2002:return n.length<10?numeric.dotMMsmall(r,n):numeric.dotMMbig(r,n);case 2001:return numeric.dotMV(r,n);case 1002:return numeric.dotVM(r,n);case 1001:return numeric.dotVV(r,n);case 1e3:return numeric.mulVS(r,n);case 1:return numeric.mulSV(r,n);case 0:return r*n;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.outer=function(r,n){return r=numeric.flatten(r),n=numeric.flatten(n),numeric.dot(numeric.transpose([r]),[n])},numeric.inner=function(r,n){return"object"!=typeof r?numeric.mul(r,n):"object"!=typeof n?numeric.mul(r,n):numeric.sum(numeric.add(r,n),-1)},numeric.roll=function(r,n,e,i,t){if("undefined"==typeof n&&(n=1),"undefined"==typeof e&&(e=-1),"undefined"==typeof i&&(i=numeric.dim(r)),"undefined"==typeof t&&(t=0),e<0&&(e=i.length+e),t===e)return r.slice(i[t]-n).concat(r.slice(0,i[t]-n));var u,o=i[t],c=Array(o);for(u=0;u<o;++u)c[u]=numeric.roll(r[u],n,e,i,t+1);return c},numeric.flip=function(r,n,e,i){if("undefined"==typeof n&&(n=-1),"undefined"==typeof e&&(e=numeric.dim(r)),"undefined"==typeof i&&(i=0),n<0&&(n=e.length+n),i===n){var t=r.slice();return t.reverse(),t}var u,o=e[i],t=Array(o);for(u=0;u<o;++u)t[u]=numeric.flip(r[u],n,e,i+1);return t},numeric.fliplr=function(r){return numeric.flip(r,-1)},numeric.flipud=function(r){return numeric.flip(r,-2)},numeric.rot90=function(r,n){"undefined"==typeof n&&(n=1);for(var e=0;e<n;e++)r=numeric.flipud(numeric.transpose(r));return r},numeric.kron=function(r,n){for(var e=numeric.dim(r),i=numeric.dim(n),t=e[0]*i[0],u=e[1]*i[1],o=numeric.rep([t,u],0),c=0;c<t;++c)for(var m=0;m<u;++m)o[c][m]=r[Math.floor(c/e[0])][Math.floor(m/i[1])]*n[c%e[0]][m%e[1]];return o},numeric.diag=function(r){var n,e,i,t,u=r.length,o=Array(u);for(n=u-1;n>=0;n--){for(t=Array(u),e=n+2,i=u-1;i>=e;i-=2)t[i]=0,t[i-1]=0;for(i>n&&(t[i]=0),t[n]=r[n],i=n-1;i>=1;i-=2)t[i]=0,t[i-1]=0;0===i&&(t[0]=0),o[n]=t}return o},numeric.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),i=Array(e);for(n=e-1;n>=1;--n)i[n]=r[n][n],--n,i[n]=r[n][n];return 0===n&&(i[0]=r[0][0]),i},numeric.setDiag=function(r,n){for(var e=0;e<n.length;e++)r[e][e]=n[e]},numeric.identity=function(r){return numeric.diag(numeric.rep([r],1))},numeric._broadcast=function(r,n,e){for(var i=0;i<e.length-n.length;i++)r=[r];return r},numeric.anonID=0,numeric.pointwise=function(r,n,e){if("undefined"==typeof r&&(r=""),"undefined"==typeof n&&(n=""),"undefined"==typeof e&&(e="binary"),"unary"===e){numeric["_anonymous"+numeric.anonID]=numeric._unary(r,n);var i=Function("x",'if(typeof x !== "object") {\n    var i=0,k=0,z=Array(1);'+n+";\n    x=[x];"+r+";\n    return z[0];} else {\n    return numeric._foreach(x,numeric.dim(x),0,numeric._anonymous"+numeric.anonID+");\n}")}else if("unary-inplace"===e){numeric["_anonymous"+numeric.anonID]=numeric._unaryeq(r,n);var i=Function("x",'if(typeof x !== "object") {\n    throw new Error("numeric: Cannot perform in-place operation on number");\n} else {\n    numeric._foreacheq(x,numeric.dim(x),0,numeric._anonymous'+numeric.anonID+");\n}")}else if("binary"===e){numeric["_anonymous"+numeric.anonID]=numeric._binary(r,n);var i=Function('var a,n=arguments.length,x=arguments[0],y,dim=numeric.dim;\nfor(a=1;a<n;++a) {\n    y = arguments[a];\n    if (typeof x === "object"\n    ||  typeof y === "object") {\n       x = numeric._broadcast(x, dim(x), dim(y));\n       y = numeric._broadcast(y, dim(y), dim(x));\n       x = numeric._biforeach(x,y,dim(x),dim(y),0,numeric._anonymous'+numeric.anonID+");\n   } else {\n       var i=0,j=0,k=0,z=Array(1);"+n+";\n       x=[x];y=[y];"+r+";\n       x=z[0];\n   }\n}\nreturn x;")}else{if("binary-inplace"!==e)throw new Error('numeric: Unknown pointwise function type "'+e+'"');numeric["_anonymous"+numeric.anonID]=numeric._binaryeq(r,n);var i=Function('var a,n=arguments.length,x=arguments[0],y,dim=numeric.dim;\nif(typeof x !== "object") {\n    throw new Error("numeric: Cannot perform in-place operation on number");\n}\nfor(a=1;a<n;++a) {\n    y = arguments[a];\n    y = numeric._broadcast(y, dim(y), dim(x));\n    numeric._biforeacheq(x,y,dim(x),dim(y),0,numeric._anonymous'+numeric.anonID+");\n}\nreturn x;")}return numeric.anonID++,i},numeric._binary=function(r,n){return Function("x","y","_n","_m","var i,j,k,z=_n===1?Array(_m):Array(_n);\n"+n+";\nif(_n === 1) { for(j=_m-1;j>=0;--j) {i=0;k=j;"+r+"} } else \nif(_m === 1) { for(i=_n-1;i>=0;--i) {j=0;k=i;"+r+"} } else \n             { for(i=_n-1;i>=0;--i) {j=i;k=i;"+r+"} }\nreturn z;")},numeric._binaryeq=function(r,n){return Function("x","y","_n","_m","var i,j,k;\n"+n+";\nif(_m === 1) { for(i=_n-1;i>=0;--i) {j=0;k=i;"+r+"} } else \n             { for(i=_n-1;i>=0;--i) {j=i;k=i;"+r+"} }\n")},numeric._unary=function(r,n){return Function("x","_n","var i,k,z=Array(_n);\n"+n+";\nfor(i=_n-1;i>=0;--i) {k=i;"+r+"}return z;")},numeric._unaryeq=function(r,n){return Function("x","_n","var i,k;\n"+n+";\nfor(i=_n-1;i>=0;--i) {k=i;"+r+"}")},numeric._biforeacheq=function r(n,e,i,t,u,o){if(u===i.length-1)return void o(n,e,i[u],t[u]);var c,m=i[u],a=t[u];if(1===a)for(c=m-1;c>=0;c--)r(n[c],e[0],i,t,u+1,o);else for(c=m-1;c>=0;c--)r(n[c],e[c],i,t,u+1,o)},numeric._biforeach=function r(n,e,i,t,u,o){if(u===i.length-1)return o(n,e,i[u],t[u]);var c,m=i[u],a=t[u],f=1===m?Array(a):Array(m);if(1===m)for(c=a-1;c>=0;--c)f[c]=r(n[0],e[c],i,t,u+1,o);else if(1===a)for(c=m-1;c>=0;--c)f[c]=r(n[c],e[0],i,t,u+1,o);else for(c=m-1;c>=0;--c)f[c]=r(n[c],e[c],i,t,u+1,o);return f},numeric._foreacheq=function r(n,e,i,t){if(i===e.length-1)return void t(n,e[i]);for(var u=e[i]-1;u>=0;u--)r(n[u],e,i+1,t)},numeric._foreach=function r(n,e,i,t){if(i===e.length-1)return t(n,e[i]);var u,o=e[i],c=Array(o);for(u=o-1;u>=0;u--)c[u]=r(n[u],e,i+1,t);return c},numeric._mapreduce=function(r,n){return Function("x","s","_n",n+"; for(var i=_n-1;i>=0;--i) { "+r+" }; return z;")},numeric.mapreduce=function(r,n){numeric["_anonymous"+numeric.anonID]=numeric._mapreduce(r,n);var e=Function("x","a","s","k",'if(typeof x !== "object") { x = [x]; }\nif(typeof a === "undefined") { x = numeric.flatten(x); a=0; }\nif(typeof s === "undefined") { s = numeric.dim(x); }\nif(typeof k === "undefined") { k = 0; }\nif(a < 0) { a = numeric.dim(x).length+a; }return numeric._mapreduceeach(x,a,s,k,numeric._anonymous'+numeric.anonID+")");return numeric.anonID++,e},numeric._mapreduceeach=function(r,n,e,i,t){if(n===i)return t(r,e.slice().splice(i+1),e[i]);var u,o=e[i],c=Array(o);for(u=o-1;u>=0;--u)c[u]=numeric._mapreduceeach(r[u],n,e,i+1,t);return c},numeric.ops1={neg:"-",not:"!",bnot:"~",bool:"!!",clone:""},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],function(){var r,n;for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],numeric.ops2[n]=n;for(r in numeric.ops2)if(numeric.ops2.hasOwnProperty(r)){n=numeric.ops2[r];var e,i,t="";numeric.myIndexOf.call(numeric.mathfuns2,r)!==-1?(t="var "+n+" = Math."+n+";",e=function(r,e,i){return r+" = "+n+"("+e+","+i+");"},i=function(r,e){return r+" = "+n+"("+r+","+e+");"}):(e=function(r,e,i){return r+" = "+e+" "+n+" "+i+";"},i=numeric.opseq.hasOwnProperty(r+"eq")?function(r,e){return r+" "+n+"= "+e+";"}:function(r,e){return r+" = "+r+" "+n+" "+e+";"}),numeric[r]=numeric.pointwise(e("z[k]","x[i]","y[j]"),t,"binary"),numeric[r+"eq"]=numeric.pointwise(i("x[k]","y[j]"),t,"binary-inplace"),numeric[n]=numeric[r],numeric[n+"="]=numeric[r+"eq"]}for(r=0;r<numeric.mathfuns2.length;++r)n=numeric.mathfuns2[r],delete numeric.ops2[n];for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],numeric.ops1[n]=n;for(r in numeric.ops1)if(numeric.ops1.hasOwnProperty(r)){var t="";n=numeric.ops1[r],numeric.myIndexOf.call(numeric.mathfuns,r)!==-1&&Math.hasOwnProperty(n)&&(t="var "+n+" = Math."+n+";"),numeric[r]=numeric.pointwise("z[k] = "+n+"(x[i]);",t,"unary"),numeric[r+"eq"]=numeric.pointwise("x[k] = "+n+"(x[i]);",t,"unary-inplace")}for(r=0;r<numeric.mathfuns.length;++r)n=numeric.mathfuns[r],delete numeric.ops1[n]}(),numeric.when=function(r,n,e){return numeric.bor(numeric.and(r,n),numeric.and(numeric.not(r),e))},numeric.clip=function(r,n,e){return numeric.min(numeric.max(r,n),e)},numeric.saturate=function(r){return numeric.clip(r,0,1)},numeric.reducers={any:["z = or(z, bool(x[i]));","var z=numeric.rep(s,false), or=numeric.or, bool=numeric.bool;"],all:["z=and(z,bool(x[i]));","var z=numeric.rep(s,true), and=numeric.and, bool=numeric.bool;"],sum:["z=add(z,x[i]);","var z=numeric.zeros(s), add=numeric.add;"],prod:["z=mul(z,x[i]);","var z=numeric.ones(s), mul=numeric.mul;"],mean:["z=add(z,div(x[i],x.length));","var z=numeric.zeros(s), add=numeric.add, div=numeric.div;"],norm1:["z=add(z,abs(x[i]))","var z=numeric.zeros(s), add=numeric.add, abs=numeric.abs;"],norminf:["z=max(z,abs(x[i]));","var z=numeric.zeros(s), max=numeric.max, abs=numeric.abs;"],norm2Squared:["z=add(z,mul(x[i],x[i]));","var z=numeric.zeros(s), add=numeric.add, mul=numeric.mul;"],sup:["z=max(z,x[i]);","var z=numeric.rep(s,-Infinity), max=numeric.max;"],inf:["z=min(z,x[i]);","var z=numeric.rep(s,Infinity), min=numeric.min;"],arginf:["z=when(lt(x[i],v),i,z);v=min(x[i],v);","var z=numeric.zeros(s), v=numeric.rep(s,Infinity),lt=numeric.lt, when=numeric.when, min=numeric.min;"],argsup:["z=when(gt(x[i],v),i,z);v=max(x[i],v);","var z=numeric.zeros(s), v=numeric.rep(s,-Infinity),gt=numeric.gt, when=numeric.when, max=numeric.max;"]},function(){var r,n;for(r in numeric.reducers)numeric.reducers.hasOwnProperty(r)&&(n=numeric.reducers[r],numeric[r]=numeric.mapreduce(n[0],n[1]))}(),numeric.variance=function(r,n){return numeric.sub(numeric.mean(numeric.pow(r,2),n),numeric.pow(numeric.mean(r,n),2))},numeric.std=function(r,n){return numeric.sqrt(numeric.variance(r,n))},numeric._parseSlice=function(r,n){var e=/^(-?\d+)?:(-?\d+)?(:(-?\d+))?$/.exec(n),i="undefined"!=typeof e[4]?parseInt(e[4]):1,t={start:"undefined"!=typeof e[1]?parseInt(e[1]):i<0?r.length-1:0,stop:"undefined"!=typeof e[2]?parseInt(e[2]):i<0?0:r.length,step:i};return t.start=t.start<0?r.length+t.start:t.start,t.stop=t.stop<0?r.length+t.stop:t.stop,t},numeric._slice=function(r,n){if("|"===n)return[r];if(":"===n)return r;if("number"==typeof n)return r[n<0?r.length+n:n];if("string"==typeof n){var e,i=numeric._parseSlice(r,n),t=[];for(e=i.start;(i.step<0?e>i.stop:e<i.stop)&&e>=0&&e<r.length;e+=i.step)t.push(r[e]);return t}},numeric.slice=function(r,n,e){if("undefined"==typeof e&&(e=0),"object"!=typeof n)return numeric.slice(r,[n],0);if(e===n.length-1)return numeric._slice(r,n[e]);if("|"===n[e])return[numeric.slice(r,n,e+1)];if("number"==typeof n[e])return numeric.slice(r[n[e]<0?r.length+n[e]:n[e]],n,e+1);if("string"==typeof n[e]){if("..."===n[e]){var i,t=numeric.dim(r).length-n.length+1;n=n.splice(1);for(var i=0;i<t;i++)n=[":"].concat(n);return numeric.slice(r,n,0)}var i,u=numeric._parseSlice(r,n[e]),o=[];for(i=u.start;(u.step<0?i>u.stop:i<u.stop)&&i>=0&&i<r.length;i+=u.step)o.push(numeric.slice(r[i],n,e+1));return o}},numeric._sliceeq=function(r,n,e){if("number"==typeof n&&(r[n<0?r.length+n:n]=e),"string"==typeof n){var i,t,u=(r.length,numeric._parseSlice(r,n));for(i=u.start,t=0;(u.step<0?i>u.stop:i<u.stop)&&i>=0&&i<r.length;i+=u.step,t++)r[i]="object"!=typeof e?e:1==e.length?e[0]:e[t]}},numeric.sliceeq=function(r,n,e,i){if("undefined"==typeof i&&(i=0),"object"!=typeof n&&numeric.sliceeq(r,[n],e,0),i===n.length-1&&numeric._sliceeq(r,n[i],e),"number"==typeof n[i]&&numeric.sliceeq(r[n[i]<0?r.length+n[i]:n[i]],n,e,i+1),"string"==typeof n[i]){if("..."===n[i]){var t,u=numeric.dim(r).length-n.length+1;n=n.splice(1);for(var t=0;t<u;t++)n=[":"].concat(n);return void numeric.sliceeq(r,n,e,0)}var t,o,c,m=numeric._parseSlice(r,n[i]);for(t=m.start,o=0;(m.step<0?t>m.stop:t<m.stop)&&t>=0&&t<r.length;t+=m.step,o++)c="object"!=typeof e?e:1==e.length?e[0]:e[o],numeric.sliceeq(r[t],n,c,i+1)}},numeric.wrap=function r(n,e,i,t){if("undefined"==typeof t&&(t=0),"undefined"==typeof i&&(i=numeric.dim(n)),"undefined"==typeof e&&(e=i.length),e<0&&(e=i.length+e),t===e)return[numeric.clone(n)];var u,o=i[t],c=Array(o);for(u=o-1;u>=0;--u)c[u]=r(n[u],e,i,t+1);return c},numeric._mask=function(r,n,e,i){var t,u=e[i],o=[];for(t=0;t<u;t++)n[t]&&o.push(r[t]);return o},numeric.mask=function r(n,e,i,t){if("undefined"==typeof t&&(t=0),"undefined"==typeof i&&(i=numeric.dim(e)),t===i.length-1)return numeric._mask(n,e,i,t);var u,o=i[t],c=[];for(u=0;u<o;u++)c=c.concat(r(n[u],e[u],i,t+1));return c},numeric._maskeq=function(r,n,e,i,t,u){var o,c=i[t];if(1===e.length)for(o=0;o<c;o++)n[o]&&(r[o]=e[0],u++);else for(o=0;o<c;o++)n[o]&&(r[o]=e[u],u++);return u},numeric.maskeq=function r(n,e,i,t,u,o){if("undefined"==typeof u&&(u=0),"undefined"==typeof o&&(o=0),"undefined"==typeof t&&(t=numeric.dim(n)),"object"!=typeof i&&(i=[i]),u===t.length-1)return numeric._maskeq(n,e,i,t,u,o);var c,m=t[u];for(c=0;c<m;c++)o=r(n[c],e[c],i,t,u+1,o);return o},numeric._index=function(r,n,e,i){var t,u=e[i],o=Array(u);for(t=u-1;t>=0;--t)o[t]=numeric.clone(r[n[t]]);return o},numeric.index=function(r,n,e,i){if("object"!=typeof n)return r[n];if("undefined"==typeof i&&(i=0),"undefined"==typeof e&&(e=numeric.dim(n)),i===e.length-1)return numeric._index(r,n,e,i);var t,u=e[i],o=Array(u);for(t=u-1;t>=0;--t)o[t]=numeric.index(r,n[t],e,i+1);return o},numeric._indexeq=function(r,n,e,i,t,u){var o,c=i[u],m=t[u];if(0===c)for(o=m-1;o>=0;--o)r[n[0]]=numeric.clone(e[o]);if(0===m)for(o=c-1;o>=0;--o)r[n[o]]=numeric.clone(e[0]);else for(o=c-1;o>=0;--o)r[n[o]]=numeric.clone(e[o])},numeric.indexeq=function(r,n,e,i,t,u){"undefined"==typeof u&&(u=0),"undefined"==typeof i&&(i=numeric.dim(n)),"undefined"==typeof t&&(t=numeric.dim(e)),u===i.length-1&&numeric._indexeq(r,n,e,i,t,u);var o,c=i[u],m=t[u];if(0===c)for(o=m-1;o>=0;--o)numeric.indexeq(r,n[0],e[o],i,t,u+1);if(0===m)for(o=c-1;o>=0;--o)numeric.indexeq(r,n[o],e[0],i,t,u+1);else for(o=c-1;o>=0;--o)numeric.indexeq(r,n[o],e[o],i,t,u+1)},numeric.trunc=numeric.pointwise("z[k] = round(x[i]/y[j])*y[j];","var round = Math.round;","binary"),numeric.inv=function(r){var n,e,i,t,u,o,c,r,m=numeric.dim(r),a=Math.abs,f=m[0],s=m[1],h=numeric.clone(r),p=numeric.identity(f);for(o=0;o<s;++o){var l=-1,y=-1;for(u=o;u!==f;++u)c=a(h[u][o]),c>y&&(l=u,y=c);for(e=h[l],h[l]=h[o],h[o]=e,t=p[l],p[l]=p[o],p[o]=t,r=e[o],c=o;c!==s;++c)e[c]/=r;for(c=s-1;c!==-1;--c)t[c]/=r;for(u=f-1;u!==-1;--u)if(u!==o){for(n=h[u],i=p[u],r=n[o],c=o+1;c!==s;++c)n[c]-=e[c]*r;for(c=s-1;c>0;--c)i[c]-=t[c]*r,--c,i[c]-=t[c]*r;0===c&&(i[0]-=t[0]*r)}}return p},numeric.det=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: det() only works on square matrices");var e,i,t,u,o,c,m,a,f=n[0],s=1,h=numeric.clone(r);for(i=0;i<f-1;i++){for(t=i,e=i+1;e<f;e++)Math.abs(h[e][i])>Math.abs(h[t][i])&&(t=e);for(t!==i&&(m=h[t],h[t]=h[i],h[i]=m,s*=-1),u=h[i],e=i+1;e<f;e++){for(o=h[e],c=o[i]/u[i],t=i+1;t<f-1;t+=2)a=t+1,o[t]-=u[t]*c,o[a]-=u[a]*c;t!==f&&(o[t]-=u[t]*c)}if(0===u[i])return 0;s*=u[i]}return s*h[i][i]},numeric.transpose=function(r){var n,e,i,t,u,o=r.length,c=r[0].length,m=Array(c);for(e=0;e<c;e++)m[e]=Array(o);for(n=o-1;n>=1;n-=2){for(t=r[n],i=r[n-1],e=c-1;e>=1;--e)u=m[e],u[n]=t[e],u[n-1]=i[e],--e,u=m[e],u[n]=t[e],u[n-1]=i[e];0===e&&(u=m[0],u[n]=t[0],u[n-1]=i[0])}if(0===n){for(i=r[0],e=c-1;e>=1;--e)m[e][0]=i[e],--e,m[e][0]=i[e];0===e&&(m[0][0]=i[0])}return m},numeric.negtranspose=function(r){var n,e,i,t,u,o=r.length,c=r[0].length,m=Array(c);for(e=0;e<c;e++)m[e]=Array(o);for(n=o-1;n>=1;n-=2){for(t=r[n],i=r[n-1],e=c-1;e>=1;--e)u=m[e],u[n]=-t[e],u[n-1]=-i[e],--e,u=m[e],u[n]=-t[e],u[n-1]=-i[e];0===e&&(u=m[0],u[n]=-t[0],u[n-1]=-i[0])}if(0===n){for(i=r[0],e=c-1;e>=1;--e)m[e][0]=-i[e],--e,m[e][0]=-i[e];0===e&&(m[0][0]=-i[0])}return m},numeric._random=function r(n,e){var i,t,u=n[e],o=Array(u);if(e===n.length-1){for(t=Math.random,i=u-1;i>=1;i-=2)o[i]=t(),o[i-1]=t();return 0===i&&(o[0]=t()),o}for(i=u-1;i>=0;i--)o[i]=r(n,e+1);return o},numeric.random=function(r){return numeric._random(r,0)},numeric.norm2=function(r,n){return numeric.sqrt(numeric.norm2Squared(r,n))},numeric.linspace=function(r,n,e){if("undefined"==typeof e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var i,t=Array(e);for(e--,i=e;i>=0;i--)t[i]=(i*n+(e-i)*r)/e;return t},numeric.logspace=function(r,n,e,i){return"undefined"==typeof i&&(i=10),numeric.pow(i,numeric.linspace(r,n,e))},numeric.range=function(r,n,e){if("undefined"==typeof e&&(e=1),"undefined"==typeof n&&(n=r,r=0),e>0&&n<r)return[];if(e<0&&n>r)return[];var i,t=[];for(i=r;i<n;i+=e)t.push(i);return t},numeric.getBlock=function(r,n,e){function i(r,u){var o,c=n[u],m=e[u]-c,a=Array(m);if(u===t.length-1){for(o=m;o>=0;o--)a[o]=r[o+c];return a}for(o=m;o>=0;o--)a[o]=i(r[o+c],u+1);return a}var t=numeric.dim(r);return i(r,0)},numeric.setBlock=function(r,n,e,i){function t(r,i,o){var c,m=n[o],a=e[o]-m;if(o===u.length-1)for(c=a;c>=0;c--)r[c+m]=i[c];for(c=a;c>=0;c--)t(r[c+m],i[c],o+1)}var u=numeric.dim(r);return t(r,i,0),r},numeric.getRange=function(r,n,e){var i,t,u,o,c=n.length,m=e.length,a=Array(c);for(i=c-1;i!==-1;--i)for(a[i]=Array(m),u=a[i],o=r[n[i]],t=m-1;t!==-1;--t)u[t]=o[e[t]];return a},numeric.blockMatrix=function(r){var n=numeric.dim(r);if(n.length<4)return numeric.blockMatrix([r]);var e,i,t,u,o,c=n[0],m=n[1];for(e=0,i=0,t=0;t<c;++t)e+=r[t][0].length;for(u=0;u<m;++u)i+=r[0][u][0].length;var a=Array(e);for(t=0;t<e;++t)a[t]=Array(i);var f,s,h,p,l,y=0;for(t=0;t<c;++t){for(f=i,u=m-1;u!==-1;--u)for(o=r[t][u],f-=o[0].length,h=o.length-1;h!==-1;--h)for(l=o[h],s=a[y+h],p=l.length-1;p!==-1;--p)s[f+p]=l[p];y+=r[t][0].length}return a},numeric.tensor=function(r,n){if("number"==typeof r||"number"==typeof n)return numeric.mul(r,n);var e=numeric.dim(r),i=numeric.dim(n);if(1!==e.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var t,u,o,c,m=e[0],a=i[0],f=Array(m);for(u=m-1;u>=0;u--){for(t=Array(a),c=r[u],o=a-1;o>=3;--o)t[o]=c*n[o],--o,t[o]=c*n[o],--o,t[o]=c*n[o],--o,t[o]=c*n[o];for(;o>=0;)t[o]=c*n[o],--o;f[u]=t}return f},numeric.T=function(r,n){this.x=r,this.y=n},numeric.t=function(r,n){return new numeric.T(r,n)},numeric.Tbinop=function(r,n,e,i,t){numeric.indexOf;if("string"!=typeof t){var u;t="";for(u in numeric)numeric.hasOwnProperty(u)&&(r.indexOf(u)>=0||n.indexOf(u)>=0||e.indexOf(u)>=0||i.indexOf(u)>=0)&&u.length>1&&(t+="var "+u+" = numeric."+u+";\n")}return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+t+"\nif(x.y) {  if(y.y) {    return new numeric.T("+i+");\n  }\n  return new numeric.T("+e+");\n}\nif(y.y) {\n  return new numeric.T("+n+");\n}\nreturn new numeric.T("+r+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var r=numeric.mul,n=numeric.div;if(this.y){var e=numeric.add(r(this.x,this.x),r(this.y,this.y));return new numeric.T(n(this.x,e),n(numeric.neg(this.y),e))}return new numeric.T(n(1,this.x),0)},numeric.T.prototype.div=function r(n){if(n instanceof numeric.T||(n=new numeric.T(n)),n.y)return this.mul(n.reciprocal());var r=numeric.div;return this.y?new numeric.T(r(this.x,n.x),r(this.y,n.x)):new numeric.T(r(this.x,n.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),r(e)):new numeric.T(r(n))},numeric.T.prototype.transjugate=function(){var r=numeric.transpose,n=this.x,e=this.y;return e?new numeric.T(r(n),numeric.negtranspose(e)):new numeric.T(r(n))},numeric.Tunop=function(r,n,e){return"string"!=typeof e&&(e=""),Function("var x = this;\n"+e+"\nif(x.y) {  "+n+";\n}\n"+r+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),
numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var r=this;if("undefined"==typeof r.y)return new numeric.T(numeric.inv(r.x));var n,e,i,t,u,o,c,m,a,f,s,n,e,i,h,p,l,y,d,g,v,x=r.x.length,b=numeric.identity(x),w=numeric.rep([x,x],0),k=numeric.clone(r.x),j=numeric.clone(r.y);for(n=0;n<x;n++){for(l=k[n][n],y=j[n][n],h=l*l+y*y,i=n,e=n+1;e<x;e++)l=k[e][n],y=j[e][n],p=l*l+y*y,p>h&&(i=e,h=p);for(i!==n&&(v=k[n],k[n]=k[i],k[i]=v,v=j[n],j[n]=j[i],j[i]=v,v=b[n],b[n]=b[i],b[i]=v,v=w[n],w[n]=w[i],w[i]=v),t=k[n],u=j[n],m=b[n],a=w[n],l=t[n],y=u[n],e=n+1;e<x;e++)d=t[e],g=u[e],t[e]=(d*l+g*y)/h,u[e]=(g*l-d*y)/h;for(e=0;e<x;e++)d=m[e],g=a[e],m[e]=(d*l+g*y)/h,a[e]=(g*l-d*y)/h;for(e=n+1;e<x;e++){for(o=k[e],c=j[e],f=b[e],s=w[e],l=o[n],y=c[n],i=n+1;i<x;i++)d=t[i],g=u[i],o[i]-=d*l-g*y,c[i]-=g*l+d*y;for(i=0;i<x;i++)d=m[i],g=a[i],f[i]-=d*l-g*y,s[i]-=g*l+d*y}}for(n=x-1;n>0;n--)for(m=b[n],a=w[n],e=n-1;e>=0;e--)for(f=b[e],s=w[e],l=k[e][n],y=j[e][n],i=x-1;i>=0;i--)d=m[i],g=a[i],f[i]-=l*d-y*g,s[i]-=l*g+y*d;return new numeric.T(b,w)},numeric.T.prototype.get=function(r){var n,e=this.x,i=this.y,t=0,u=r.length;if(i){for(;t<u;)n=r[t],e=e[n],i=i[n],t++;return new numeric.T(e,i)}for(;t<u;)n=r[t],e=e[n],t++;return new numeric.T(e)},numeric.T.prototype.set=function(r,n){var e,i=this.x,t=this.y,u=0,o=r.length,c=n.x,m=n.y;if(0===o)return m?this.y=m:t&&(this.y=void 0),this.x=i,this;if(m){for(t||(t=numeric.rep(numeric.dim(i),0),this.y=t);u<o-1;)e=r[u],i=i[e],t=t[e],u++;return e=r[u],i[e]=c,t[e]=m,this}if(t){for(;u<o-1;)e=r[u],i=i[e],t=t[e],u++;return e=r[u],i[e]=c,c instanceof Array?t[e]=numeric.rep(numeric.dim(c),0):t[e]=0,this}for(;u<o-1;)e=r[u],i=i[e],u++;return e=r[u],i[e]=c,this},numeric.T.prototype.getRows=function(r,n){var e,i,t=n-r+1,u=Array(t),o=this.x,c=this.y;for(e=r;e<=n;e++)u[e-r]=o[e];if(c){for(i=Array(t),e=r;e<=n;e++)i[e-r]=c[e];return new numeric.T(u,i)}return new numeric.T(u)},numeric.T.prototype.setRows=function(r,n,e){var i,t=this.x,u=this.y,o=e.x,c=e.y;for(i=r;i<=n;i++)t[i]=o[i-r];if(c)for(u||(u=numeric.rep(numeric.dim(t),0),this.y=u),i=r;i<=n;i++)u[i]=c[i-r];else if(u)for(i=r;i<=n;i++)u[i]=numeric.rep([o[i-r].length],0);return this},numeric.T.prototype.getRow=function(r){var n=this.x,e=this.y;return e?new numeric.T(n[r],e[r]):new numeric.T(n[r])},numeric.T.prototype.setRow=function(r,n){var e=this.x,i=this.y,t=n.x,u=n.y;return e[r]=t,u?(i||(i=numeric.rep(numeric.dim(e),0),this.y=i),i[r]=u):i&&(i=numeric.rep([t.length],0)),this},numeric.T.prototype.getBlock=function(r,n){var e=this.x,i=this.y,t=numeric.getBlock;return i?new numeric.T(t(e,r,n),t(i,r,n)):new numeric.T(t(e,r,n))},numeric.T.prototype.setBlock=function(r,n,e){e instanceof numeric.T||(e=new numeric.T(e));var i=this.x,t=this.y,u=numeric.setBlock,o=e.x,c=e.y;return c?(t||(this.y=numeric.rep(numeric.dim(this),0),t=this.y),u(i,r,n,o),u(t,r,n,c),this):(u(i,r,n,o),void(t&&u(t,r,n,numeric.rep(numeric.dim(o),0))))},numeric.T.rep=function(r,n){var e=numeric.T;n instanceof e||(n=new e(n));var i=n.x,t=n.y,u=numeric.rep;return t?new e(u(r,i),u(r,t)):new e(u(r,i))},numeric.T.diag=function r(n){n instanceof numeric.T||(n=new numeric.T(n));var e=n.x,i=n.y,r=numeric.diag;return i?new numeric.T(r(e),r(i)):new numeric.T(r(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(r){return new numeric.T(numeric.identity(r))},numeric.T.prototype.getDiag=function(){var r=numeric,n=this.x,e=this.y;return e?new r.T(r.getDiag(n),r.getDiag(e)):new r.T(r.getDiag(n))},numeric.house=function(r){var n=numeric.clone(r),e=r[0]>=0?1:-1,i=e*numeric.norm2(r);n[0]+=i;var t=numeric.norm2(n);if(0===t)throw new Error("eig: internal error");return numeric.div(n,t)},numeric.toUpperHessenberg=function(r){var n=numeric.dim(r);if(2!==n.length||n[0]!==n[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e,i,t,u,o,c,m,a,f,s,h=n[0],p=numeric.clone(r),l=numeric.identity(h);for(i=0;i<h-2;i++){for(u=Array(h-i-1),e=i+1;e<h;e++)u[e-i-1]=p[e][i];if(numeric.norm2(u)>0){for(o=numeric.house(u),c=numeric.getBlock(p,[i+1,i],[h-1,h-1]),m=numeric.tensor(o,numeric.dot(o,c)),e=i+1;e<h;e++)for(a=p[e],f=m[e-i-1],t=i;t<h;t++)a[t]-=2*f[t-i];for(c=numeric.getBlock(p,[0,i+1],[h-1,h-1]),m=numeric.tensor(numeric.dot(c,o),o),e=0;e<h;e++)for(a=p[e],f=m[e],t=i+1;t<h;t++)a[t]-=2*f[t-i-1];for(c=Array(h-i-1),e=i+1;e<h;e++)c[e-i-1]=l[e];for(m=numeric.tensor(o,numeric.dot(o,c)),e=i+1;e<h;e++)for(s=l[e],f=m[e-i-1],t=0;t<h;t++)s[t]-=2*f[t]}}return{H:p,Q:l}},numeric.epsilon=2.220446049250313e-16,numeric.pi=3.141592653589793,numeric.e=2.718281828459045,numeric.QRFrancis=function(r,n){"undefined"==typeof n&&(n=1e4),r=numeric.clone(r);var e,i,t,u,o,c,m,a,f,s,h,p,l,y,d,g,v,x,b=(numeric.clone(r),numeric.dim(r)),w=b[0],k=numeric.identity(w);if(w<3)return{Q:k,B:[[0,w-1]]};var j=numeric.epsilon;for(x=0;x<n;x++){for(g=0;g<w-1;g++)if(Math.abs(r[g+1][g])<j*(Math.abs(r[g][g])+Math.abs(r[g+1][g+1]))){var M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[g,g]),n),A=numeric.QRFrancis(numeric.getBlock(r,[g+1,g+1],[w-1,w-1]),n);for(p=Array(g+1),d=0;d<=g;d++)p[d]=k[d];for(l=numeric.dot(M.Q,p),d=0;d<=g;d++)k[d]=l[d];for(p=Array(w-g-1),d=g+1;d<w;d++)p[d-g-1]=k[d];for(l=numeric.dot(A.Q,p),d=g+1;d<w;d++)k[d]=l[d-g-1];return{Q:k,B:M.B.concat(numeric.add(A.B,g+1))}}if(t=r[w-2][w-2],u=r[w-2][w-1],o=r[w-1][w-2],c=r[w-1][w-1],a=t+c,m=t*c-u*o,f=numeric.getBlock(r,[0,0],[2,2]),a*a>=4*m){var T,_;T=.5*(a+Math.sqrt(a*a-4*m)),_=.5*(a-Math.sqrt(a*a-4*m)),f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,T+_)),numeric.diag(numeric.rep([3],T*_)))}else f=numeric.add(numeric.sub(numeric.dot(f,f),numeric.mul(f,a)),numeric.diag(numeric.rep([3],m)));for(e=[f[0][0],f[1][0],f[2][0]],i=numeric.house(e),p=[r[0],r[1],r[2]],l=numeric.tensor(i,numeric.dot(i,p)),d=0;d<3;d++)for(h=r[d],y=l[d],v=0;v<w;v++)h[v]-=2*y[v];for(p=numeric.getBlock(r,[0,0],[w-1,2]),l=numeric.tensor(numeric.dot(p,i),i),d=0;d<w;d++)for(h=r[d],y=l[d],v=0;v<3;v++)h[v]-=2*y[v];for(p=[k[0],k[1],k[2]],l=numeric.tensor(i,numeric.dot(i,p)),d=0;d<3;d++)for(s=k[d],y=l[d],v=0;v<w;v++)s[v]-=2*y[v];var q;for(g=0;g<w-2;g++){for(v=g;v<=g+1;v++)if(Math.abs(r[v+1][v])<j*(Math.abs(r[v][v])+Math.abs(r[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(r,[0,0],[v,v]),n),A=numeric.QRFrancis(numeric.getBlock(r,[v+1,v+1],[w-1,w-1]),n);for(p=Array(v+1),d=0;d<=v;d++)p[d]=k[d];for(l=numeric.dot(M.Q,p),d=0;d<=v;d++)k[d]=l[d];for(p=Array(w-v-1),d=v+1;d<w;d++)p[d-v-1]=k[d];for(l=numeric.dot(A.Q,p),d=v+1;d<w;d++)k[d]=l[d-v-1];return{Q:k,B:M.B.concat(numeric.add(A.B,v+1))}}for(q=Math.min(w-1,g+3),e=Array(q-g),d=g+1;d<=q;d++)e[d-g-1]=r[d][g];for(i=numeric.house(e),p=numeric.getBlock(r,[g+1,g],[q,w-1]),l=numeric.tensor(i,numeric.dot(i,p)),d=g+1;d<=q;d++)for(h=r[d],y=l[d-g-1],v=g;v<w;v++)h[v]-=2*y[v-g];for(p=numeric.getBlock(r,[0,g+1],[w-1,q]),l=numeric.tensor(numeric.dot(p,i),i),d=0;d<w;d++)for(h=r[d],y=l[d],v=g+1;v<=q;v++)h[v]-=2*y[v-g-1];for(p=Array(q-g),d=g+1;d<=q;d++)p[d-g-1]=k[d];for(l=numeric.tensor(i,numeric.dot(i,p)),d=g+1;d<=q;d++)for(s=k[d],y=l[d-g-1],v=0;v<w;v++)s[v]-=2*y[v]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(r,n){var e,i,t,u,o,c,m,a,f,s,h,p,l,y,d,g,v,x=numeric.toUpperHessenberg(r),b=numeric.QRFrancis(x.H,n),w=numeric.T,k=r.length,j=b.B,M=numeric.dot(b.Q,numeric.dot(x.H,numeric.transpose(b.Q))),A=new w(numeric.dot(b.Q,x.Q)),T=j.length,_=Math.sqrt;for(i=0;i<T;i++)if(e=j[i][0],e===j[i][1]);else{if(u=e+1,o=M[e][e],c=M[e][u],m=M[u][e],a=M[u][u],0===c&&0===m)continue;f=-o-a,s=o*a-c*m,h=f*f-4*s,h>=0?(p=f<0?-.5*(f-_(h)):-.5*(f+_(h)),g=(o-p)*(o-p)+c*c,v=m*m+(a-p)*(a-p),g>v?(g=_(g),y=(o-p)/g,d=c/g):(v=_(v),y=m/v,d=(a-p)/v),t=new w([[d,-y],[y,d]]),A.setRows(e,u,t.dot(A.getRows(e,u)))):(p=-.5*f,l=.5*_(-h),g=(o-p)*(o-p)+c*c,v=m*m+(a-p)*(a-p),g>v?(g=_(g+l*l),y=(o-p)/g,d=c/g,p=0,l/=g):(v=_(v+l*l),y=m/v,d=(a-p)/v,p=l/v,l=0),t=new w([[d,-y],[y,d]],[[p,l],[l,-p]]),A.setRows(e,u,t.dot(A.getRows(e,u))))}var q=A.dot(r).dot(A.transjugate()),k=r.length,z=numeric.T.identity(k);for(u=0;u<k;u++)if(u>0)for(i=u-1;i>=0;i--){var P=q.get([i,i]),S=q.get([u,u]);numeric.neq(P.x,S.x)||numeric.neq(P.y,S.y)?(p=q.getRow(i).getBlock([i],[u-1]),l=z.getRow(u).getBlock([i],[u-1]),z.set([u,i],q.get([i,u]).neg().sub(p.dot(l)).div(P.sub(S)))):z.setRow(u,z.getRow(i))}for(u=0;u<k;u++)p=z.getRow(u),z.setRow(u,p.div(p.norm2()));return z=z.transpose(),z=A.transjugate().dot(z),{lambda:q.getDiag(),E:z}},numeric.ccsSparse=function(r){var n,e,i,t,u=r.length,o=[];for(i=u-1;i!==-1;--i){e=r[i];for(t in e){for(t=parseInt(t);t>=o.length;)o[o.length]=0;0!==e[t]&&o[t]++}}var n=o.length,c=Array(n+1);for(c[0]=0,i=0;i<n;++i)c[i+1]=c[i]+o[i];var m=Array(c[n]),a=Array(c[n]);for(i=u-1;i!==-1;--i){e=r[i];for(t in e)0!==e[t]&&(o[t]--,m[c[t]+o[t]]=i,a[c[t]+o[t]]=e[t])}return[c,m,a]},numeric.ccsFull=function(r){var n,e,i,t,u=r[0],o=r[1],c=r[2],m=numeric.ccsDim(r),a=m[0],f=m[1],s=numeric.rep([a,f],0);for(n=0;n<f;n++)for(i=u[n],t=u[n+1],e=i;e<t;++e)s[o[e]][n]=c[e];return s},numeric.ccsTSolve=function(r,n,e,i,t){function u(r){var n;if(0===e[r]){for(e[r]=1,n=o[r];n<o[r+1];++n)u(c[n]);t[s]=r,++s}}var o=r[0],c=r[1],m=r[2],a=o.length-1,f=Math.max,s=0;"undefined"==typeof i&&(e=numeric.rep([a],0)),"undefined"==typeof i&&(i=numeric.linspace(0,e.length-1)),"undefined"==typeof t&&(t=[]);var h,p,l,y,d,g,v;for(h=i.length-1;h!==-1;--h)u(i[h]);for(t.length=s,h=t.length-1;h!==-1;--h)e[t[h]]=0;for(h=i.length-1;h!==-1;--h)p=i[h],e[p]=n[p];for(h=t.length-1;h!==-1;--h){for(p=t[h],l=o[p],y=f(o[p+1],l),d=l;d!==y;++d)if(c[d]===p){e[p]/=m[d];break}for(v=e[p],d=l;d!==y;++d)g=c[d],g!==p&&(e[g]-=v*m[d])}return e},numeric.ccsDFS=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS.prototype.dfs=function(r,n,e,i,t,u){var o,c,m,a=0,f=t.length,s=this.k,h=this.k1,p=this.j;if(0===i[r])for(i[r]=1,p[0]=r,s[0]=c=n[r],h[0]=m=n[r+1];;)if(c>=m){if(t[f]=p[a],0===a)return;++f,--a,c=s[a],m=h[a]}else o=u[e[c]],0===i[o]?(i[o]=1,s[a]=c,++a,p[a]=o,c=n[o],h[a]=m=n[o+1]):++c},numeric.ccsLPSolve=function(r,n,e,i,t,u,o){var c,m,a,f,s,h,p,l,y,d=r[0],g=r[1],v=r[2],x=(d.length-1,n[0]),b=n[1],w=n[2];for(m=x[t],a=x[t+1],i.length=0,c=m;c<a;++c)o.dfs(u[b[c]],d,g,e,i,u);for(c=i.length-1;c!==-1;--c)e[i[c]]=0;for(c=m;c!==a;++c)f=u[b[c]],e[f]=w[c];for(c=i.length-1;c!==-1;--c){for(f=i[c],s=d[f],h=d[f+1],p=s;p<h;++p)if(u[g[p]]===f){e[f]/=v[p];break}for(y=e[f],p=s;p<h;++p)l=u[g[p]],l!==f&&(e[l]-=y*v[p])}return e},numeric.ccsLUP1=function(r,n){var e,i,t,u,o,c,m,a=r[0].length-1,f=[numeric.rep([a+1],0),[],[]],s=[numeric.rep([a+1],0),[],[]],h=f[0],p=f[1],l=f[2],y=s[0],d=s[1],g=s[2],v=numeric.rep([a],0),x=numeric.rep([a],0),b=numeric.ccsLPSolve,w=(Math.max,Math.abs),k=numeric.linspace(0,a-1),j=numeric.linspace(0,a-1),M=new numeric.ccsDFS(a);for("undefined"==typeof n&&(n=1),e=0;e<a;++e){for(b(f,r,v,x,e,j,M),u=-1,o=-1,i=x.length-1;i!==-1;--i)t=x[i],t<=e||(c=w(v[t]),c>u&&(o=t,u=c));for(w(v[e])<n*u&&(i=k[e],u=k[o],k[e]=u,j[u]=e,k[o]=i,j[i]=o,u=v[e],v[e]=v[o],v[o]=u),u=h[e],o=y[e],m=v[e],p[u]=k[e],l[u]=1,++u,i=x.length-1;i!==-1;--i)t=x[i],c=v[t],x[i]=0,v[t]=0,t<=e?(d[o]=t,g[o]=c,++o):(p[u]=k[t],l[u]=c/m,++u);h[e+1]=u,y[e+1]=o}for(i=p.length-1;i!==-1;--i)p[i]=j[p[i]];return{L:f,U:s,P:k,Pinv:j}},numeric.ccsDFS0=function(r){this.k=Array(r),this.k1=Array(r),this.j=Array(r)},numeric.ccsDFS0.prototype.dfs=function(r,n,e,i,t,u,o){var c,m,a,f=0,s=t.length,h=this.k,p=this.k1,l=this.j;if(0===i[r])for(i[r]=1,l[0]=r,h[0]=m=n[u[r]],p[0]=a=n[u[r]+1];;){if(isNaN(m))throw new Error("Ow!");if(m>=a){if(t[s]=u[l[f]],0===f)return;++s,--f,m=h[f],a=p[f]}else c=e[m],0===i[c]?(i[c]=1,h[f]=m,++f,l[f]=c,c=u[c],m=n[c],p[f]=a=n[c+1]):++m}},numeric.ccsLPSolve0=function(r,n,e,i,t,u,o,c){var m,a,f,s,h,p,l,y,d,g=r[0],v=r[1],x=r[2],b=(g.length-1,n[0]),w=n[1],k=n[2];for(a=b[t],f=b[t+1],i.length=0,m=a;m<f;++m)c.dfs(w[m],g,v,e,i,u,o);for(m=i.length-1;m!==-1;--m)s=i[m],e[o[s]]=0;for(m=a;m!==f;++m)s=w[m],e[s]=k[m];for(m=i.length-1;m!==-1;--m){for(s=i[m],y=o[s],h=g[s],p=g[s+1],l=h;l<p;++l)if(v[l]===y){e[y]/=x[l];break}for(d=e[y],l=h;l<p;++l)e[v[l]]-=d*x[l];e[y]=d}},numeric.ccsLUP0=function(r,n){var e,i,t,u,o,c,m,a=r[0].length-1,f=[numeric.rep([a+1],0),[],[]],s=[numeric.rep([a+1],0),[],[]],h=f[0],p=f[1],l=f[2],y=s[0],d=s[1],g=s[2],v=numeric.rep([a],0),x=numeric.rep([a],0),b=numeric.ccsLPSolve0,w=(Math.max,Math.abs),k=numeric.linspace(0,a-1),j=numeric.linspace(0,a-1),M=new numeric.ccsDFS0(a);for("undefined"==typeof n&&(n=1),e=0;e<a;++e){for(b(f,r,v,x,e,j,k,M),u=-1,o=-1,i=x.length-1;i!==-1;--i)t=x[i],t<=e||(c=w(v[k[t]]),c>u&&(o=t,u=c));for(w(v[k[e]])<n*u&&(i=k[e],u=k[o],k[e]=u,j[u]=e,k[o]=i,j[i]=o),u=h[e],o=y[e],m=v[k[e]],p[u]=k[e],l[u]=1,++u,i=x.length-1;i!==-1;--i)t=x[i],c=v[k[t]],x[i]=0,v[k[t]]=0,t<=e?(d[o]=t,g[o]=c,++o):(p[u]=k[t],l[u]=c/m,++u);h[e+1]=u,y[e+1]=o}for(i=p.length-1;i!==-1;--i)p[i]=j[p[i]];return{L:f,U:s,P:k,Pinv:j}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(r){return[numeric.sup(r[1])+1,r[0].length-1]},numeric.ccsGetBlock=function(r,n,e){var i=numeric.ccsDim(r),t=i[0],u=i[1];"undefined"==typeof n?n=numeric.linspace(0,t-1):"number"==typeof n&&(n=[n]),"undefined"==typeof e?e=numeric.linspace(0,u-1):"number"==typeof e&&(e=[e]);var o,c,m,a,f,s=n.length,h=e.length,p=numeric.rep([u],0),l=[],y=[],d=[p,l,y],g=r[0],v=r[1],x=r[2],b=numeric.rep([t],0),w=0,k=numeric.rep([t],0);for(c=0;c<h;++c){a=e[c];var j=g[a],M=g[a+1];for(o=j;o<M;++o)m=v[o],k[m]=1,b[m]=x[o];for(o=0;o<s;++o)f=n[o],k[f]&&(l[w]=o,y[w]=b[n[o]],++w);for(o=j;o<M;++o)m=v[o],k[m]=0;p[c+1]=w}return d},numeric.ccsDot=function(r,n){var e,i,t,u,o,c,m,a,f,s,h,p=r[0],l=r[1],y=r[2],d=n[0],g=n[1],v=n[2],x=numeric.ccsDim(r),b=numeric.ccsDim(n),w=x[0],k=(x[1],b[1]),j=numeric.rep([w],0),M=numeric.rep([w],0),A=Array(w),T=numeric.rep([k],0),_=[],q=[],z=[T,_,q];for(t=0;t!==k;++t){for(u=d[t],o=d[t+1],f=0,i=u;i<o;++i)for(s=g[i],h=v[i],c=p[s],m=p[s+1],e=c;e<m;++e)a=l[e],0===M[a]&&(A[f]=a,M[a]=1,f+=1),j[a]=j[a]+y[e]*h;for(u=T[t],o=u+f,T[t+1]=o,i=f-1;i!==-1;--i)h=u+i,e=A[i],_[h]=e,q[h]=j[e],M[e]=0,j[e]=0;T[t+1]=T[t]+f}return z},numeric.ccsLUPSolve=function(r,n){var e=r.L,i=r.U,t=(r.P,n[0]),u=!1;"object"!=typeof t&&(n=[[0,n.length],numeric.linspace(0,n.length-1),n],t=n[0],u=!0);var o,c,m,a,f,s,h=n[1],p=n[2],l=e[0].length-1,y=t.length-1,d=numeric.rep([l],0),g=Array(l),v=numeric.rep([l],0),x=Array(l),b=numeric.rep([y+1],0),w=[],k=[],j=numeric.ccsTSolve,M=0;for(o=0;o<y;++o){for(f=0,m=t[o],a=t[o+1],c=m;c<a;++c)s=r.Pinv[h[c]],x[f]=s,v[s]=p[c],++f;for(x.length=f,j(e,v,d,x,g),c=x.length-1;c!==-1;--c)v[x[c]]=0;if(j(i,d,v,g,x),u)return v;for(c=g.length-1;c!==-1;--c)d[g[c]]=0;for(c=x.length-1;c!==-1;--c)s=x[c],w[M]=s,k[M]=v[s],v[s]=0,++M;b[o+1]=M}return[b,w,k]},numeric.ccsbinop=function(r,n){return"undefined"==typeof n&&(n=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+n+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+r+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(r){var n,e=r[0],i=r[1],t=r[2],u=numeric.sup(i)+1,o=e.length,c=numeric.rep([u],0),m=Array(o),a=Array(o),f=numeric.rep([u],0);for(n=0;n<o;++n)f[i[n]]++;for(n=0;n<u;++n)c[n+1]=c[n]+f[n];var s,h,p=c.slice(0);for(n=0;n<o;++n)h=i[n],s=p[h],m[s]=e[n],a[s]=t[n],p[h]=p[h]+1;return[c,m,a]},numeric.ccsGather=function(r){var n,e,i,t,u,o=r[0],c=r[1],m=r[2],a=o.length-1,f=c.length,s=Array(f),h=Array(f),p=Array(f);for(u=0,n=0;n<a;++n)for(i=o[n],t=o[n+1],e=i;e!==t;++e)h[u]=n,s[u]=c[e],p[u]=m[e],++u;return[s,h,p]},numeric.sdim=function r(n,e,i){if("undefined"==typeof e&&(e=[]),"object"!=typeof n)return e;"undefined"==typeof i&&(i=0),i in e||(e[i]=0),n.length>e[i]&&(e[i]=n.length);var t;for(t in n)n.hasOwnProperty(t)&&r(n[t],e,i+1);return e},numeric.sclone=function r(n,e,i){"undefined"==typeof e&&(e=0),"undefined"==typeof i&&(i=numeric.sdim(n).length);var t,u=Array(n.length);if(e===i-1){for(t in n)n.hasOwnProperty(t)&&(u[t]=n[t]);return u}for(t in n)n.hasOwnProperty(t)&&(u[t]=r(n[t],e+1,i));return u},numeric.sdiag=function(r){var n,e,i=r.length,t=Array(i);for(n=i-1;n>=1;n-=2)e=n-1,t[n]=[],t[n][n]=r[n],t[e]=[],t[e][e]=r[e];return 0===n&&(t[0]=[],t[0][0]=r[n]),t},numeric.sidentity=function(r){return numeric.sdiag(numeric.rep([r],1))},numeric.stranspose=function(r){var n,e,i,t=[];r.length;for(n in r)if(r.hasOwnProperty(n)){i=r[n];for(e in i)i.hasOwnProperty(e)&&("object"!=typeof t[e]&&(t[e]=[]),t[e][n]=i[e])}return t},numeric.sLUP=function(r,n){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(r,n){var e,i,t,u,o,c,m,a=r.length,f=(n.length,numeric.stranspose(n)),s=f.length,h=Array(a);for(t=a-1;t>=0;t--){for(m=[],e=r[t],o=s-1;o>=0;o--){c=0,i=f[o];for(u in e)e.hasOwnProperty(u)&&u in i&&(c+=e[u]*i[u]);c&&(m[o]=c)}h[t]=m}return h},numeric.sdotMV=function(r,n){var e,i,t,u,o=r.length,c=Array(o);for(i=o-1;i>=0;i--){e=r[i],u=0;for(t in e)e.hasOwnProperty(t)&&n[t]&&(u+=e[t]*n[t]);u&&(c[i]=u)}return c},numeric.sdotVM=function(r,n){var e,i,t,u,o=[];for(e in r)if(r.hasOwnProperty(e)){t=n[e],u=r[e];for(i in t)t.hasOwnProperty(i)&&(o[i]||(o[i]=0),o[i]+=u*t[i])}return o},numeric.sdotVV=function(r,n){var e,i=0;for(e in r)r[e]&&n[e]&&(i+=r[e]*n[e]);return i},numeric.sdot=function(r,n){var e=numeric.sdim(r).length,i=numeric.sdim(n).length,t=1e3*e+i;switch(t){case 0:return r*n;case 1001:return numeric.sdotVV(r,n);case 2001:return numeric.sdotMV(r,n);case 1002:return numeric.sdotVM(r,n);case 2002:return numeric.sdotMM(r,n);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+i)}},numeric.sscatter=function(r){var n,e,i,t,u=r[0].length,o=r.length,c=[];for(e=u-1;e>=0;--e)if(r[o-1][e]){for(t=c,i=0;i<o-2;i++)n=r[i][e],t[n]||(t[n]=[]),t=t[n];t[r[i][e]]=r[i+1][e]}return c},numeric.sgather=function r(n,e,i){"undefined"==typeof e&&(e=[]),"undefined"==typeof i&&(i=[]);var t,u,o;t=i.length;for(u in n)if(n.hasOwnProperty(u))if(i[t]=parseInt(u),o=n[u],"number"==typeof o){if(o){if(0===e.length)for(u=t+1;u>=0;--u)e[u]=[];for(u=t;u>=0;--u)e[u].push(i[u]);e[t+1].push(o)}}else r(o,e,i);return i.length>t&&i.pop(),e},numeric.cLU=function(r){var n,e,i,t,u,o,c=r[0],m=r[1],a=r[2],f=c.length,s=0;for(n=0;n<f;n++)c[n]>s&&(s=c[n]);s++;var h,p,l,y=Array(s),d=Array(s),g=numeric.rep([s],1/0),v=numeric.rep([s],-(1/0));for(i=0;i<f;i++)n=c[i],e=m[i],e<g[n]&&(g[n]=e),e>v[n]&&(v[n]=e);for(n=0;n<s-1;n++)v[n]>v[n+1]&&(v[n+1]=v[n]);for(n=s-1;n>=1;n--)g[n]<g[n-1]&&(g[n-1]=g[n]);var x=0,b=0;for(n=0;n<s;n++)d[n]=numeric.rep([v[n]-g[n]+1],0),y[n]=numeric.rep([n-g[n]],0),x+=n-g[n]+1,b+=v[n]-n+1;for(i=0;i<f;i++)n=c[i],d[n][m[i]-g[n]]=a[i];for(n=0;n<s-1;n++)for(t=n-g[n],h=d[n],e=n+1;g[e]<=n&&e<s;e++)if(u=n-g[e],o=v[n]-n,p=d[e],l=p[u]/h[t]){for(i=1;i<=o;i++)p[i+u]-=l*h[i+t];y[e][n-g[e]]=l}var f,w,k,h=[],p=[],j=[],M=[],A=[],T=[];for(f=0,w=0,n=0;n<s;n++){for(t=g[n],u=v[n],k=d[n],e=n;e<=u;e++)k[e-t]&&(h[f]=n,p[f]=e,j[f]=k[e-t],f++);for(k=y[n],e=t;e<n;e++)k[e-t]&&(M[w]=n,A[w]=e,T[w]=k[e-t],w++);M[w]=n,A[w]=n,T[w]=1,w++}return{U:[h,p,j],L:[M,A,T]}},numeric.cLUsolve=function(r,n){var e,i,t=r.L,u=r.U,o=numeric.clone(n),c=t[0],m=t[1],a=t[2],f=u[0],s=u[1],h=u[2],p=f.length,l=(c.length,o.length);for(i=0,e=0;e<l;e++){for(;m[i]<e;)o[e]-=a[i]*o[m[i]],i++;i++}for(i=p-1,e=l-1;e>=0;e--){for(;s[i]>e;)o[e]-=h[i]*o[s[i]],i--;o[e]/=h[i],i--}return o},numeric.cgrid=function(r,n){"number"==typeof r&&(r=[r,r]);var e,i,t,u=numeric.rep(r,-1);if("function"!=typeof n)switch(n){case"L":n=function(n,e){return n>=r[0]/2||e<r[1]/2};break;default:n=function(r,n){return!0}}for(t=0,e=1;e<r[0]-1;e++)for(i=1;i<r[1]-1;i++)n(e,i)&&(u[e][i]=t,t++);return u},numeric.cdelsq=function(r){var n,e,i,t,u,o=[[-1,0],[0,-1],[0,1],[1,0]],c=numeric.dim(r),m=c[0],a=c[1],f=[],s=[],h=[];for(n=1;n<m-1;n++)for(e=1;e<a-1;e++)if(!(r[n][e]<0)){for(i=0;i<4;i++)t=n+o[i][0],u=e+o[i][1],r[t][u]<0||(f.push(r[n][e]),s.push(r[t][u]),h.push(-1));f.push(r[n][e]),s.push(r[n][e]),h.push(4)}return[f,s,h]},numeric.cdotMV=function(r,n){var e,i,t,u=r[0],o=r[1],c=r[2],m=u.length;for(t=0,i=0;i<m;i++)u[i]>t&&(t=u[i]);for(t++,e=numeric.rep([t],0),i=0;i<m;i++)e[u[i]]+=c[i]*n[o[i]];return e},numeric.Spline=function(r,n,e,i,t){this.x=r,this.yl=n,this.yr=e,this.kl=i,this.kr=t},numeric.Spline.prototype._at=function(r,n){var r,e,i,t,u=this.x,o=this.yl,c=this.yr,m=this.kl,a=this.kr,f=numeric.add,s=numeric.sub,h=numeric.mul;e=s(h(m[n],u[n+1]-u[n]),s(c[n+1],o[n])),i=f(h(a[n+1],u[n]-u[n+1]),s(c[n+1],o[n])),t=(r-u[n])/(u[n+1]-u[n]);var p=t*(1-t);return f(f(f(h(1-t,o[n]),h(t,c[n+1])),h(e,p*(1-t))),h(i,p*t))},numeric.Spline.prototype.at=function(r){if("number"==typeof r){var n,e,i,t=this.x,u=t.length,o=Math.floor;for(n=0,e=u-1;e-n>1;)i=o((n+e)/2),t[i]<=r?n=i:e=i;return this._at(r,n)}var c,u=r.length,m=Array(u);for(c=u-1;c!==-1;--c)m[c]=this.at(r[c]);return m},numeric.Spline.prototype.diff=function(){var r,n,e,i=this.x,t=this.yl,u=this.yr,o=this.kl,c=this.kr,m=t.length,a=o,f=c,s=Array(m),h=Array(m),p=numeric.add,l=numeric.mul,y=numeric.div,d=numeric.sub;for(r=m-1;r!==-1;--r)n=i[r+1]-i[r],e=d(u[r+1],t[r]),s[r]=y(p(l(e,6),l(o[r],-4*n),l(c[r+1],-2*n)),n*n),h[r+1]=y(p(l(e,-6),l(o[r],2*n),l(c[r+1],4*n)),n*n);return new numeric.Spline(i,a,f,s,h)},numeric.Spline.prototype.roots=function(){function r(r){return r*r}var n=[],e=this.x,i=this.yl,t=this.yr,u=this.kl,o=this.kr;"number"==typeof i[0]&&(i=[i],t=[t],u=[u],o=[o]);var c,m,a,f,s,h,p,l,y,d,g,v,x,b,w,k,j,M,A,T,_,q,z,P,S=i.length,F=e.length-1,n=Array(S),D=Math.sqrt;for(c=0;c!==S;++c){for(f=i[c],s=t[c],h=u[c],p=o[c],l=[],m=0;m!==F;m++){for(m>0&&s[m]*f[m]<0&&l.push(e[m]),k=e[m+1]-e[m],j=e[m],g=f[m],v=s[m+1],y=h[m]/k,d=p[m+1]/k,w=r(y-d+3*(g-v))+12*d*g,x=d+3*g+2*y-3*v,b=3*(d+y+2*(g-v)),w<=0?(A=x/b,M=A>e[m]&&A<e[m+1]?[e[m],A,e[m+1]]:[e[m],e[m+1]]):(A=(x-D(w))/b,T=(x+D(w))/b,M=[e[m]],A>e[m]&&A<e[m+1]&&M.push(A),T>e[m]&&T<e[m+1]&&M.push(T),M.push(e[m+1])),q=M[0],A=this._at(q,m),a=0;a<M.length-1;a++)if(z=M[a+1],T=this._at(z,m),0!==A)if(0===T||A*T>0)q=z,A=T;else{for(var L=0;;){if(P=(A*z-T*q)/(A-T),P<=q||P>=z)break;if(_=this._at(P,m),_*T>0)z=P,T=_,L===-1&&(A*=.5),L=-1;else{if(!(_*A>0))break;q=P,A=_,1===L&&(T*=.5),L=1}}l.push(P),q=M[a+1],A=this._at(q,m)}else l.push(q),q=z,A=T;0===T&&l.push(z)}n[c]=l}return"number"==typeof this.yl[0]?n[0]:n},numeric.spline=function(r,n,e,i){var t,u=r.length,o=[],c=[],m=[],a=numeric.sub,f=numeric.mul,s=numeric.add;for(t=u-2;t>=0;t--)c[t]=r[t+1]-r[t],m[t]=a(n[t+1],n[t]);"string"!=typeof e&&"string"!=typeof i||(e=i="periodic");var h=[[],[],[]];switch(typeof e){case"undefined":o[0]=f(3/(c[0]*c[0]),m[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/c[0],1/c[0]);break;case"string":o[0]=s(f(3/(c[u-2]*c[u-2]),m[u-2]),f(3/(c[0]*c[0]),m[0])),h[0].push(0,0,0),h[1].push(u-2,0,1),h[2].push(1/c[u-2],2/c[u-2]+2/c[0],1/c[0]);break;default:o[0]=e,h[0].push(0),h[1].push(0),h[2].push(1)}for(t=1;t<u-1;t++)o[t]=s(f(3/(c[t-1]*c[t-1]),m[t-1]),f(3/(c[t]*c[t]),m[t])),h[0].push(t,t,t),h[1].push(t-1,t,t+1),h[2].push(1/c[t-1],2/c[t-1]+2/c[t],1/c[t]);switch(typeof i){case"undefined":o[u-1]=f(3/(c[u-2]*c[u-2]),m[u-2]),h[0].push(u-1,u-1),h[1].push(u-2,u-1),h[2].push(1/c[u-2],2/c[u-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[u-1]=i,h[0].push(u-1),h[1].push(u-1),h[2].push(1)}o="number"!=typeof o[0]?numeric.transpose(o):[o];var p=Array(o.length);if("string"==typeof e)for(t=p.length-1;t!==-1;--t)p[t]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[t]),p[t][u-1]=p[t][0];else for(t=p.length-1;t!==-1;--t)p[t]=numeric.cLUsolve(numeric.cLU(h),o[t]);return p="number"==typeof n[0]?p[0]:numeric.transpose(p),new numeric.Spline(r,n,n,p,p)},numeric.fftpow2=function r(n,e){var i=n.length;if(1!==i){var t,u,o=Math.cos,c=Math.sin,m=Array(i/2),a=Array(i/2),f=Array(i/2),s=Array(i/2);for(u=i/2,t=i-1;t!==-1;--t)--u,f[u]=n[t],s[u]=e[t],--t,m[u]=n[t],a[u]=e[t];r(m,a),r(f,s),u=i/2;var h,p,l,y=-6.283185307179586/i;for(t=i-1;t!==-1;--t)--u,u===-1&&(u=i/2-1),h=y*t,p=o(h),l=c(h),n[t]=m[u]+p*f[u]-l*s[u],e[t]=a[u]+p*s[u]+l*f[u]}},numeric._ifftpow2=function r(n,e){var i=n.length;if(1!==i){var t,u,o=Math.cos,c=Math.sin,m=Array(i/2),a=Array(i/2),f=Array(i/2),s=Array(i/2);for(u=i/2,t=i-1;t!==-1;--t)--u,f[u]=n[t],s[u]=e[t],--t,m[u]=n[t],a[u]=e[t];r(m,a),r(f,s),u=i/2;var h,p,l,y=6.283185307179586/i;for(t=i-1;t!==-1;--t)--u,u===-1&&(u=i/2-1),h=y*t,p=o(h),l=c(h),n[t]=m[u]+p*f[u]-l*s[u],e[t]=a[u]+p*s[u]+l*f[u]}},numeric.ifftpow2=function(r,n){numeric._ifftpow2(r,n),numeric.diveq(r,r.length),numeric.diveq(n,n.length)},numeric.convpow2=function(r,n,e,i){numeric.fftpow2(r,n),numeric.fftpow2(e,i);var t,u,o,c,m,a=r.length;for(t=a-1;t!==-1;--t)u=r[t],c=n[t],o=e[t],m=i[t],r[t]=u*o-c*m,n[t]=u*m+c*o;numeric.ifftpow2(r,n)},numeric.T.prototype.fft=function(){var r,n,e=this.x,i=this.y,t=e.length,u=Math.log,o=u(2),c=Math.ceil(u(2*t-1)/o),m=Math.pow(2,c),a=numeric.rep([m],0),f=numeric.rep([m],0),s=Math.cos,h=Math.sin,p=-numeric.pi/t,l=numeric.rep([m],0),y=numeric.rep([m],0);Math.floor(t/2);for(r=0;r<t;r++)l[r]=e[r];if("undefined"!=typeof i)for(r=0;r<t;r++)y[r]=i[r];for(a[0]=1,r=1;r<=m/2;r++)n=p*r*r,a[r]=s(n),f[r]=h(n),a[m-r]=s(n),f[m-r]=h(n);var d=new numeric.T(l,y),g=new numeric.T(a,f);return d=d.mul(g),numeric.convpow2(d.x,d.y,numeric.clone(g.x),numeric.neg(g.y)),d=d.mul(g),d.x.length=t,d.y.length=t,d},numeric.T.prototype.ifft=function(){var r,n,e=this.x,i=this.y,t=e.length,u=Math.log,o=u(2),c=Math.ceil(u(2*t-1)/o),m=Math.pow(2,c),a=numeric.rep([m],0),f=numeric.rep([m],0),s=Math.cos,h=Math.sin,p=numeric.pi/t,l=numeric.rep([m],0),y=numeric.rep([m],0);Math.floor(t/2);for(r=0;r<t;r++)l[r]=e[r];if("undefined"!=typeof i)for(r=0;r<t;r++)y[r]=i[r];for(a[0]=1,r=1;r<=m/2;r++)n=p*r*r,a[r]=s(n),f[r]=h(n),a[m-r]=s(n),f[m-r]=h(n);var d=new numeric.T(l,y),g=new numeric.T(a,f);return d=d.mul(g),numeric.convpow2(d.x,d.y,numeric.clone(g.x),numeric.neg(g.y)),d=d.mul(g),d.x.length=t,d.y.length=t,d.div(t)},numeric.gradient=function(r,n){var e=n.length,i=r(n);if(isNaN(i))throw new Error("gradient: f(x) is a NaN!");var t,u,o,c,m,a,f,s,h,p,l=Math.max,y=numeric.clone(n),d=Array(e),l=(numeric.div,numeric.sub,Math.max),g=.001,v=Math.abs,x=Math.min,b=0;for(t=0;t<e;t++)for(var w=l(1e-6*i,1e-8);;){if(++b,b>20)throw new Error("Numerical gradient fails");if(y[t]=n[t]+w,u=r(y),y[t]=n[t]-w,o=r(y),y[t]=n[t],isNaN(u)||isNaN(o))w/=16;else{if(d[t]=(u-o)/(2*w),m=n[t]-w,a=n[t],f=n[t]+w,s=(u-i)/w,h=(i-o)/w,p=l(v(d[t]),v(i),v(u),v(o),v(m),v(a),v(f),1e-8),c=x(l(v(s-d[t]),v(h-d[t]),v(s-h))/p,w/p),!(c>g))break;w/=16}}return d},numeric.uncmin=function(r,n,e,i,t,u,o){var c=numeric.gradient;"undefined"==typeof o&&(o={}),"undefined"==typeof e&&(e=1e-8),"undefined"==typeof i&&(i=function(n){return c(r,n)}),"undefined"==typeof t&&(t=1e3),n=numeric.clone(n);var m,a,f=n.length,s=r(n);if(isNaN(s))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,p=numeric.norm2;e=h(e,numeric.epsilon);var l,y,d,g,v,x,b,w,k,j,M=o.Hinv||numeric.identity(f),A=numeric.dot,T=(numeric.inv,numeric.sub),_=numeric.add,q=numeric.tensor,z=numeric.div,P=numeric.mul,S=numeric.all,F=numeric.isFinite,D=numeric.neg,L=0,N="";for(y=i(n);L<t;){if("function"==typeof u&&u(L,n,s,y,M)){N="Callback returned true";break}if(!S(F(y))){N="Gradient has Infinity or NaN";break}if(l=D(A(M,y)),!S(F(l))){N="Search direction has Infinity or NaN";break}if(j=p(l),j<e){N="Newton step smaller than tol";break}for(k=1,a=A(y,l),v=n;L<t&&!(k*j<e)&&(g=P(l,k),v=_(n,g),m=r(v),m-s>=.1*k*a||isNaN(m));)k*=.5,++L;if(k*j<e){N="Line search step size smaller than tol";break}if(L===t){N="maxit reached during line search";break}d=i(v),x=T(d,y),w=A(x,g),b=A(M,x),M=T(_(M,P((w+A(x,b))/(w*w),q(g,g))),z(_(q(b,g),q(g,b)),w)),n=v,s=m,y=d,++L}return{solution:n,f:s,gradient:y,invHessian:M,iterations:L,message:N}},numeric.Dopri=function(r,n,e,i,t,u,o){this.x=r,this.y=n,this.f=e,this.ymid=i,this.iterations=t,this.events=o,this.message=u},numeric.Dopri.prototype._at=function(r,n){function e(r){return r*r}var i,t,u,o,c,m,r,a,f,s,h,p=this,l=p.x,y=p.y,d=p.f,g=p.ymid,v=(l.length,Math.floor,.5),x=numeric.add,b=numeric.mul,w=numeric.sub;return i=l[n],t=l[n+1],o=y[n],c=y[n+1],a=t-i,u=i+v*a,m=g[n],f=w(d[n],b(o,1/(i-u)+2/(i-t))),s=w(d[n+1],b(c,1/(t-u)+2/(t-i))),h=[e(r-t)*(r-u)/e(i-t)/(i-u),e(r-i)*e(r-t)/e(i-u)/e(t-u),e(r-i)*(r-u)/e(t-i)/(t-u),(r-i)*e(r-t)*(r-u)/e(i-t)/(i-u),(r-t)*e(r-i)*(r-u)/e(i-t)/(t-u)],x(x(x(x(b(o,h[0]),b(m,h[1])),b(c,h[2])),b(f,h[3])),b(s,h[4]))};numeric.Dopri.prototype.at=function(r){var n,e,i,t=Math.floor;if("number"!=typeof r){var u=r.length,o=Array(u);for(n=u-1;n!==-1;--n)o[n]=this.at(r[n]);return o}var c=this.x;for(n=0,e=c.length-1;e-n>1;)i=t(.5*(n+e)),c[i]<=r?n=i:e=i;return this._at(r,n)};numeric.dopri=function(r,n,e,i,t,u,o){"undefined"==typeof t&&(t=1e-6),"undefined"==typeof u&&(u=1e3);var c,m,a,f,s,h,p,l,y,d,g,v,x,b=[r],w=[e],k=[i(r,e)],j=[],M=.2,A=[.075,.225],T=[44/45,-56/15,32/9],_=[19372/6561,-25360/2187,64448/6561,-212/729],q=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],z=[35/384,0,500/1113,125/192,-2187/6784,11/84],P=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,.023904308236133973],S=[.2,.3,.8,8/9,1,1],F=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],D=0,L=(n-r)/10,N=0,I=numeric.add,O=numeric.mul,U=(Math.max,Math.min),B=Math.abs,E=numeric.norminf,R=Math.pow,X=numeric.any,V=numeric.lt,Y=numeric.and,Q=(numeric.sub,new numeric.Dopri(b,w,k,j,(-1),""));for("function"==typeof o&&(g=o(r,e));r<n&&N<u;)if(++N,r+L>n&&(L=n-r),c=i(r+S[0]*L,I(e,O(M*L,k[D]))),m=i(r+S[1]*L,I(I(e,O(A[0]*L,k[D])),O(A[1]*L,c))),a=i(r+S[2]*L,I(I(I(e,O(T[0]*L,k[D])),O(T[1]*L,c)),O(T[2]*L,m))),f=i(r+S[3]*L,I(I(I(I(e,O(_[0]*L,k[D])),O(_[1]*L,c)),O(_[2]*L,m)),O(_[3]*L,a))),s=i(r+S[4]*L,I(I(I(I(I(e,O(q[0]*L,k[D])),O(q[1]*L,c)),O(q[2]*L,m)),O(q[3]*L,a)),O(q[4]*L,f))),y=I(I(I(I(I(e,O(k[D],L*z[0])),O(m,L*z[2])),O(a,L*z[3])),O(f,L*z[4])),O(s,L*z[5])),h=i(r+L,y),p=I(I(I(I(I(O(k[D],L*F[0]),O(m,L*F[2])),O(a,L*F[3])),O(f,L*F[4])),O(s,L*F[5])),O(h,L*F[6])),d="number"==typeof p?B(p):E(p),d>t){if(L=.2*L*R(t/d,.25),r+L===r){Q.msg="Step size became too small";break}}else{if(j[D]=I(I(I(I(I(I(e,O(k[D],L*P[0])),O(m,L*P[2])),O(a,L*P[3])),O(f,L*P[4])),O(s,L*P[5])),O(h,L*P[6])),++D,b[D]=r+L,w[D]=y,k[D]=h,"function"==typeof o){
var Z,C,H=r,G=r+.5*L;if(v=o(G,j[D-1]),x=Y(V(g,0),V(0,v)),X(x)||(H=G,G=r+L,g=v,v=o(G,y),x=Y(V(g,0),V(0,v))),X(x)){for(var W,$,J=0,K=1,rr=1;;){if("number"==typeof g)C=(rr*v*H-K*g*G)/(rr*v-K*g);else for(C=G,l=g.length-1;l!==-1;--l)g[l]<0&&v[l]>0&&(C=U(C,(rr*v[l]*H-K*g[l]*G)/(rr*v[l]-K*g[l])));if(C<=H||C>=G)break;Z=Q._at(C,D-1),$=o(C,Z),W=Y(V(g,0),V(0,$)),X(W)?(G=C,v=$,x=W,rr=1,J===-1?K*=.5:K=1,J=-1):(H=C,g=$,K=1,1===J?rr*=.5:rr=1,J=1)}return y=Q._at(.5*(r+C),D-1),Q.f[D]=i(C,Z),Q.x[D]=C,Q.y[D]=Z,Q.ymid[D-1]=y,Q.events=x,Q.iterations=N,Q}}r+=L,e=y,g=v,L=U(.8*L*R(t/d,.25),4*L)}return Q.iterations=N,Q},numeric.LU=function(r,n){n=n||!1;var e,i,t,u,o,c,m,a,f,s=Math.abs,h=r.length,p=h-1,l=new Array(h);for(n||(r=numeric.clone(r)),t=0;t<h;++t){for(m=t,c=r[t],f=s(c[t]),i=t+1;i<h;++i)u=s(r[i][t]),f<u&&(f=u,m=i);for(l[t]=m,m!=t&&(r[t]=r[m],r[m]=c,c=r[t]),o=c[t],e=t+1;e<h;++e)r[e][t]/=o;for(e=t+1;e<h;++e){for(a=r[e],i=t+1;i<p;++i)a[i]-=a[t]*c[i],++i,a[i]-=a[t]*c[i];i===p&&(a[i]-=a[t]*c[i])}}return{LU:r,P:l}},numeric.LUsolve=function(r,n){var e,i,t,u,o,c=r.LU,m=c.length,a=numeric.clone(n),f=r.P;for(e=m-1;e!==-1;--e)a[e]=n[e];for(e=0;e<m;++e)for(t=f[e],f[e]!==e&&(o=a[e],a[e]=a[t],a[t]=o),u=c[e],i=0;i<e;++i)a[e]-=a[i]*u[i];for(e=m-1;e>=0;--e){for(u=c[e],i=e+1;i<m;++i)a[e]-=a[i]*u[i];a[e]/=u[e]}return a},numeric.solve=function(r,n,e){return numeric.LUsolve(numeric.LU(r,e),n)},numeric.echelonize=function(r){var n,e,i,t,u,o,c,m,a=numeric.dim(r),f=a[0],s=a[1],h=numeric.identity(f),p=Array(f),l=Math.abs,y=numeric.diveq;for(r=numeric.clone(r),n=0;n<f;++n){for(i=0,u=r[n],o=h[n],e=1;e<s;++e)l(u[i])<l(u[e])&&(i=e);for(p[n]=i,y(o,u[i]),y(u,u[i]),e=0;e<f;++e)if(e!==n){for(c=r[e],m=c[i],t=s-1;t!==-1;--t)c[t]-=u[t]*m;for(c=h[e],t=f-1;t!==-1;--t)c[t]-=o[t]*m}}return{I:h,A:r,P:p}},numeric.__solveLP=function(r,n,e,i,t,u,o){var c,m,a,f,s=numeric.sum,h=(numeric.log,numeric.mul),p=numeric.sub,l=numeric.dot,y=numeric.div,d=numeric.add,g=r.length,v=e.length,x=!1,b=0,w=1,k=(numeric.transpose(n),numeric.svd,numeric.transpose),j=(numeric.leq,Math.sqrt),M=Math.abs,A=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,_=numeric.gt,q=Array(g),z=Array(v),P=(numeric.rep([v],1),numeric.solve),S=p(e,l(n,u)),F=l(r,r);for(a=b;a<t;++a){var D,L;for(D=v-1;D!==-1;--D)z[D]=y(n[D],S[D]);var N=k(z);for(D=g-1;D!==-1;--D)q[D]=s(N[D]);w=.25*M(F/l(r,q));var I=100*j(F/l(q,q));for((!isFinite(w)||w>I)&&(w=I),f=d(r,h(w,q)),m=l(N,z),D=g-1;D!==-1;--D)m[D][D]+=1;L=P(m,y(f,w),!0);var O=y(S,l(n,L)),U=1;for(D=v-1;D!==-1;--D)O[D]<0&&(U=A(U,-.999*O[D]));if(c=p(u,h(L,U)),S=p(e,l(n,c)),!T(_(S,0)))return{solution:u,message:"",iterations:a};if(u=c,w<i)return{solution:c,message:"",iterations:a};if(o){var B=l(r,f),E=l(n,f);for(x=!0,D=v-1;D!==-1;--D)if(B*E[D]<0){x=!1;break}}else x=!(u[g-1]>=0);if(x)return{solution:c,message:"Unbounded",iterations:a}}return{solution:u,message:"maximum iteration count exceeded",iterations:a}},numeric._solveLP=function(r,n,e,i,t){var u,o=r.length,c=e.length,m=(numeric.sum,numeric.log,numeric.mul,numeric.sub),a=numeric.dot,f=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),s=numeric.rep([c,1],-1),h=numeric.blockMatrix([[n,s]]),p=e,u=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(e)))+1),l=numeric.__solveLP(f,h,p,i,t,u,!1),y=numeric.clone(l.solution);y.length=o;var d=numeric.inf(m(e,a(n,y)));if(d<0)return{solution:NaN,message:"Infeasible",iterations:l.iterations};var g=numeric.__solveLP(r,n,e,i,t-l.iterations,y,!0);return g.iterations+=l.iterations,g},numeric.solveLP=function(r,n,e,i,t,u,o){if("undefined"==typeof o&&(o=1e3),"undefined"==typeof u&&(u=numeric.epsilon),"undefined"==typeof i)return numeric._solveLP(r,n,e,u,o);var c,m=i.length,a=i[0].length,f=n.length,s=numeric.echelonize(i),h=numeric.rep([a],0),p=s.P,l=[];for(c=p.length-1;c!==-1;--c)h[p[c]]=1;for(c=a-1;c!==-1;--c)0===h[c]&&l.push(c);var y=numeric.getRange,d=numeric.linspace(0,m-1),g=numeric.linspace(0,f-1),v=y(i,d,l),x=y(n,g,p),b=y(n,g,l),w=numeric.dot,k=numeric.sub,j=w(x,s.I),M=k(b,w(j,v)),A=k(e,w(j,t)),T=Array(p.length),_=Array(l.length);for(c=p.length-1;c!==-1;--c)T[c]=r[p[c]];for(c=l.length-1;c!==-1;--c)_[c]=r[l[c]];var q=k(_,w(T,w(s.I,v))),z=numeric._solveLP(q,M,A,u,o),P=z.solution;if(P!==P)return z;var S=w(s.I,k(t,w(v,P))),F=Array(r.length);for(c=p.length-1;c!==-1;--c)F[p[c]]=S[c];for(c=l.length-1;c!==-1;--c)F[l[c]]=P[c];return{solution:F,message:z.message,iterations:z.iterations}},numeric.MPStoLP=function(r){function n(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+r[e]+"\nCurrent state: "+c[o]+"\n")}r instanceof String&&r.split("\n");var e,i,t,u,o=0,c=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],m=r.length,a=0,f={},s=[],h=0,p={},l=0,y=[],d=[],g=[];for(e=0;e<m;++e){t=r[e];var v=t.match(/\S*/g),x=[];for(i=0;i<v.length;++i)""!==v[i]&&x.push(v[i]);if(0!==x.length){for(i=0;i<c.length&&t.substr(0,c[i].length)!==c[i];++i);if(i<c.length){if(o=i,1===i&&(u=x[1]),6===i)return{name:u,c:y,A:numeric.transpose(d),b:g,rows:f,vars:p}}else switch(o){case 0:case 1:n("Unexpected line");case 2:switch(x[0]){case"N":0===a?a=x[1]:n("Two or more N rows");break;case"L":f[x[1]]=h,s[h]=1,g[h]=0,++h;break;case"G":f[x[1]]=h,s[h]=-1,g[h]=0,++h;break;case"E":f[x[1]]=h,s[h]=0,g[h]=0,++h;break;default:n("Parse error "+numeric.prettyPrint(x))}break;case 3:p.hasOwnProperty(x[0])||(p[x[0]]=l,y[l]=0,d[l]=numeric.rep([h],0),++l);var b=p[x[0]];for(i=1;i<x.length;i+=2)if(x[i]!==a){var w=f[x[i]];d[b][w]=(s[w]<0?-1:1)*parseFloat(x[i+1])}else y[b]=parseFloat(x[i+1]);break;case 4:for(i=1;i<x.length;i+=2)g[f[x[i]]]=(s[f[x[i]]]<0?-1:1)*parseFloat(x[i+1]);break;case 5:break;case 6:n("Internal error")}}}n("Reached end of file without ENDATA")},numeric.eigh=function(r,n){return"y"in r?numeric.jacobi_hermitian(r,n):numeric.jacobi_real_symmetric(r,n)},numeric.jacobinorm=function(r,n){var e=r.length,i=0;if(n)for(var t=0;t<e;t++)for(var u=t+1;u<e;u++)i=i+Math.pow(r[t][u],2)+Math.pow(n[t][u],2);else for(var t=0;t<e;t++)for(var u=t+1;u<e;u++)i+=Math.pow(r[t][u],2);return Math.sqrt(i)},numeric.jacobi_real_symmetric=function(r,n,e){e||(e={});var i=[r.length,r[0].length];if(i[0]!=i[1])throw"jacobi : matrix must be square";var t=i[0],u=numeric.identity(t);if("clone"in e&&e.clone!==!0)var o=r;else var o=numeric.clone(r);for(var c,m,a,f,s,h,p,l,y,d,g,v=numeric.rep([n],0),x=numeric.getDiag(o),b=numeric.clone(x),w=numeric.rep([t],0),k=-1,j=0,M=0,A=0;k<n;){if(k++,v[k]=numeric.jacobinorm(o),j=k,A=v[k]/(4*t),0==A)return{E:{x:u,y:numeric.rep([t,t],0)},lambda:{x:x},iterations:v,niter:j,nrot:M};for(var T=0;T<t;T++)for(var _=T+1;_<t;_++)if(a=10*Math.abs(o[T][_]),s=a+Math.abs(x[T]),h=a+Math.abs(x[_]),k>4&&s==Math.abs(x[T])&&h==Math.abs(x[_]))o[T][_]=0;else if(k>4||Math.abs(o[T][_])>=A){c=x[_]-x[T],f=Math.abs(c)+a,f==Math.abs(c)?l=o[T][_]/c:(p=.5*c/o[T][_],l=1/(Math.abs(p)+Math.sqrt(1+p*p)),p<0&&(l=-l)),y=1/Math.sqrt(1+l*l),d=l*y,g=d/(1+y),c=l*o[T][_],w[T]=w[T]-c,w[_]=w[_]+c,x[T]=x[T]-c,x[_]=x[_]+c,o[T][_]=0;for(var q=0;q<T;q++)m=o[q][T],c=o[q][_],o[q][T]=m-d*(c+m*g),o[q][_]=c+d*(m-c*g);for(var q=T+1;q<_;q++)m=o[T][q],c=o[q][_],o[T][q]=m-d*(c+m*g),o[q][_]=c+d*(m-c*g);for(var q=_+1;q<t;q++)m=o[T][q],c=o[_][q],o[T][q]=m-d*(c+m*g),o[_][q]=c+d*(m-c*g);for(var q=0;q<t;q++)m=u[T][q],c=u[_][q],u[T][q]=m-d*(c+m*g),u[_][q]=c+d*(m-c*g);M++}b=numeric.add(b,w),x=numeric.clone(b),w=numeric.rep([t],0)}return{E:numeric.t(u,numeric.rep([t,t],0)),lambda:numeric.t(x,numeric.rep([t],0)),iterations:v,niter:j,nrot:M}},numeric.jacobi_hermitian=function(r,n,e){function i(r,n){return r*r+n*n}function t(r,n){return r.x*n.x-r.y*n.y}function u(r,n){return r.x*n.x+r.y*n.y}function o(r,n){return r.x*n.y+r.y*n.x}function c(r,n){return r.x*n.y-r.y*n.x}e||(e={});var m=[r.x.length,r.x[0].length];if(m[0]!=m[1])throw"jacobi : matrix must be square";var a=m[0];if("clone"in e&&e.clone!==!0)var f=r.x,s=r.y;else var f=numeric.clone(r.x),s=numeric.clone(r.y);for(var h,p,l,y,d,g,v,x,b,w,k,j=numeric.identity(a),M=numeric.rep([a,a],0),A=numeric.rep([n],0),T=numeric.getDiag(f),_=numeric.clone(T),q=numeric.rep([a],0),z=-1,P=0,S=0,F=0;z<n;){if(z++,A[z]=numeric.jacobinorm(f,s),P=z,F=A[z]/(4*a),0==F)return{E:{x:j,y:M},lambda:{x:T},iterations:A,niter:P,nrot:S};for(var D=0;D<a;D++)for(var L=D+1;L<a;L++)if(h={x:f[D][L],y:s[D][L],sq:i(f[D][L],s[D][L])},y=10*h.sq,g=y+Math.abs(T[D]),v=y+Math.abs(T[L]),z>4&&g==Math.abs(T[D])&&v==Math.abs(T[L]))f[D][L]=0,s[D][L]=0;else if(z>4||h.sq>=F){p=.5*(T[L]-T[D]),d=Math.abs(p)+y,d==Math.abs(p)?x=.5/p:(x=1/(Math.abs(p)+Math.sqrt(h.sq+p*p)),p<0&&(x=-x)),p=x*h.sq,b=1/Math.sqrt(1+p*x),w=-x*b,k=w*h.sq/(b+1),q[D]=q[D]-p,q[L]=q[L]+p,T[D]=T[D]-p,T[L]=T[L]+p,f[D][L]=0,s[D][L]=0;for(var N=0;N<D;N++)l={x:f[N][D],y:s[N][D]},p={x:f[N][L],y:s[N][L]},f[N][D]=l.x+w*(u(h,p)-k*l.x),s[N][D]=l.y+w*(c(h,p)-k*l.y),f[N][L]=p.x-w*(t(h,l)+k*p.x),s[N][L]=p.y-w*(o(h,l)+k*p.y);for(var N=D+1;N<L;N++)l={x:f[D][N],y:s[D][N]},p={x:f[N][L],y:s[N][L]},f[D][N]=l.x+w*(u(p,h)-k*l.x),s[D][N]=l.y+w*(c(p,h)-k*l.y),f[N][L]=p.x-w*(u(l,h)+k*p.x),s[N][L]=p.y-w*(c(l,h)+k*p.y);for(var N=L+1;N<a;N++)l={x:f[D][N],y:s[D][N]},p={x:f[L][N],y:s[L][N]},f[D][N]=l.x+w*(t(h,p)-k*l.x),s[D][N]=l.y+w*(o(h,p)-k*l.y),f[L][N]=p.x-w*(u(h,l)+k*p.x),s[L][N]=p.y-w*(c(h,l)+k*p.y);for(var N=0;N<a;N++)l={x:j[D][N],y:M[D][N]},p={x:j[L][N],y:M[L][N]},j[D][N]=l.x+w*(t(h,p)-k*l.x),M[D][N]=l.y+w*(o(h,p)-k*l.y),j[L][N]=p.x-w*(u(h,l)+k*p.x),M[L][N]=p.y-w*(c(h,l)+k*p.y);S+=1}_=numeric.add(_,q),T=numeric.clone(_),q=numeric.rep([a],0)}return{E:numeric.t(j,M),lambda:numeric.t(T,numeric.rep([a],0)),iterations:A,niter:P,nrot:S}}}(numeric);